<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Подготовка по технике безопасности</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi0KHRg9C80L7RgdGC0LXRgNC90LDRhtC40Y4g0L/QtdGA0LLQuNC90L7RgdC40Y8g0LrQvtC90YbQtdCy0L7RgiIsInNob3J0X25hbWUiOiLQodGD0LzQvtGB0YLQtdGA0L3QsNGG0LjRjiIsImRlc2NyaXB0aW9uIjoi0J7Qv9C40YHQsNC90LjRjyDQstC10LvQsNC10LzQtdC90L3QviDQvdCwINGB0YPQvNC+0YHRgtC10YDQvdCw0YbQuNGOINC60L7QvdGG0LXQstC+0YIsInN0YXJ0X3VybCI6Ii4iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjZjhmOWZhIiwidGhlbWVfY29sb3IiOiIjMzQ5OGRiIn0=">
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --accent-color: #f39c12;
            --text-color: #333;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --border-color: #e0e0e0;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --education-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --education-card: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --gold-bg: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            --gold-card: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        
        body.dark-theme {
            --primary-color: #4a9eff;
            --secondary-color: #00d68f;
            --accent-color: #ff9f43;
            --text-color: #e0e0e0;
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --border-color: #333333;
            --success-color: #00d68f;
            --warning-color: #ff9f43;
            --danger-color: #ff6b6b;
            --education-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            --education-card: linear-gradient(135deg, #2d3561 0%, #0f3460 100%);
            --gold-bg: linear-gradient(135deg, #2a2a2a 0%, #3d3d3d 100%);
            --gold-card: linear-gradient(135deg, #3a3a3a 0%, #4d4d4d 100%);
        }
        
        body {
            background: var(--education-bg);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            color: var(--text-color);
            overflow-x: hidden;
            transition: background 0.3s ease;
            position: relative;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.03) 0%, transparent 15%);
            background-size: 200px 200px;
            pointer-events: none;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 800px;
            padding: 30px;
            position: relative;
            overflow: hidden;
            background-color: var(--card-bg);
            transition: background-color 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));
        }
        
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 25px;
            font-size: 2.2rem;
            line-height: 1.2;
            font-weight: 700;
            position: relative;
            padding-bottom: 15px;
        }
        
        h1::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }
        
        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: var(--text-color);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.3);
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .btn {
            background: linear-gradient(45deg, var(--primary-color), #2980b9);
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 300px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            z-index: -1;
        }
        
        .btn:hover::before {
            transform: translateX(0);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #2980b9, var(--primary-color));
        }
        
        .btn:after {
            content: "";
            display: block;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            background-image: radial-gradient(circle, #fff 10%, transparent 10.01%);
            background-repeat: no-repeat;
            background-position: 50%;
            transform: scale(10, 10);
            opacity: 0;
            transition: transform .5s, opacity 1s;
        }
        
        .btn:active:after {
            transform: scale(0, 0);
            opacity: .3;
            transition: 0s;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-exam {
            background: linear-gradient(45deg, var(--danger-color), #c0392b);
        }
        
        .btn-exam:hover {
            background: linear-gradient(45deg, #c0392b, var(--danger-color));
        }
        
        .btn-hint {
            background: linear-gradient(45deg, var(--warning-color), #e67e22);
            font-size: 0.9rem;
            padding: 12px 20px;
            max-width: 200px;
        }
        
        .btn-hint:hover {
            background: linear-gradient(45deg, #e67e22, var(--warning-color));
        }
        
        .btn-hint:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-favorite {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            font-size: 0.9rem;
            padding: 12px 20px;
            max-width: 200px;
            display: none;
        }
        
        .btn-favorite:hover {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
        }
        
        .btn-favorite.active {
            background: linear-gradient(45deg, var(--danger-color), #c0392b);
        }
        
        .btn-favorite.active:hover {
            background: linear-gradient(45deg, #c0392b, var(--danger-color));
        }
        
        .btn-restart {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }
        
        .btn-restart:hover {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
        }
        
        .btn-search {
            background: linear-gradient(45deg, #3498db, #2980b9);
            font-size: 0.9rem;
            padding: 12px 20px;
            max-width: 200px;
        }
        
        .btn-search:hover {
            background: linear-gradient(45deg, #2980b9, #3498db);
        }
        
        .btn-cards {
            background: linear-gradient(45deg, #16a085, #1abc9c);
            font-size: 0.9rem;
            padding: 12px 20px;
            max-width: 200px;
        }
        
        .btn-cards:hover {
            background: linear-gradient(45deg, #1abc9c, #16a085);
        }
        
        .btn-admin {
            background: linear-gradient(45deg, #34495e, #2c3e50);
            font-size: 0.9rem;
            padding: 12px 20px;
            max-width: 200px;
        }
        
        .btn-admin:hover {
            background: linear-gradient(45deg, #2c3e50, #34495e);
        }
        
        .btn-gold {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }
        
        .btn-gold:hover {
            background: linear-gradient(45deg, #e67e22, #f39c12);
        }
        
        .btn-leaderboard {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .btn-leaderboard:hover {
            background: linear-gradient(45deg, #c0392b, #e74c3c);
        }
        
        .btn-feedback {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
        }
        
        .btn-feedback:hover {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
        }
        
        .hidden-mode {
            display: none !important;
        }
        
        .question-container {
            background: var(--education-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid var(--primary-color);
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            animation: fadeInScale 0.5s ease-out;
        }
        
        .gold-question-container {
            background: var(--gold-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #f39c12;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            animation: fadeInScale 0.5s ease-out;
        }
        
        @keyframes fadeInScale {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .question-container:hover, .gold-question-container:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .question {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 25px;
            color: var(--text-color);
            line-height: 1.5;
            position: relative;
            padding-left: 35px;
        }
        
        .question::before {
            content: "\f059";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 0;
            top: 0;
            color: var(--primary-color);
            font-size: 1.5rem;
        }
        
        .gold-question::before {
            content: "\f3e5";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 0;
            top: 0;
            color: #f39c12;
            font-size: 1.5rem;
        }
        
        .options {
            display: grid;
            grid-gap: 15px;
        }
        
        .option {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            line-height: 1.5;
            min-height: 70px;
            display: flex;
            align-items: center;
            color: var(--text-color);
            position: relative;
            overflow: hidden;
            animation: slideInFromRight 0.4s ease-out;
            animation-fill-mode: both;
        }
        
        @keyframes slideInFromRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .option:nth-child(1) { animation-delay: 0.1s; }
        .option:nth-child(2) { animation-delay: 0.2s; }
        .option:nth-child(3) { animation-delay: 0.3s; }
        .option:nth-child(4) { animation-delay: 0.4s; }
        
        .option::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            width: 5px;
            height: 100%;
            background: var(--primary-color);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        
        .option:hover {
            border-color: var(--primary-color);
            background: rgba(0, 0, 0, 0.05);
            transform: translateX(5px);
        }
        
        .option:hover::before {
            transform: scaleY(1);
        }
        
        .option.correct {
            background: #d4edda;
            border-color: var(--success-color);
            font-weight: 600;
            animation: correctPulse 0.6s ease;
        }
        
        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 15px rgba(46, 204, 113, 0.7); }
            100% { transform: scale(1); }
        }
        
        .option.correct::before {
            background: var(--success-color);
            transform: scaleY(1);
        }
        
        .option.incorrect {
            background: #f8d7da;
            border-color: var(--danger-color);
            animation: incorrectShake 0.6s ease;
        }
        
        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .option.incorrect::before {
            background: var(--danger-color);
            transform: scaleY(1);
        }
        
        .option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .timer {
            background: var(--danger-color);
            color: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.3rem;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .timer::before {
            content: "\f017";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
        }
        
        .ticket-info {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .ticket-info::before {
            content: "\f15c";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
        }
        
        .result {
            text-align: center;
            padding: 20px;
        }
        
        .result h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.8rem;
            position: relative;
            padding-bottom: 15px;
        }
        
        .result h2::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }
        
        .result-score {
            font-size: 3rem;
            font-weight: bold;
            margin: 20px 0;
            color: var(--secondary-color);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .result-message {
            font-size: 1.2rem;
            margin-bottom: 30px;
            line-height: 1.5;
            color: var(--text-color);
        }
        
        .progress-bar {
            height: 12px;
            background: var(--border-color);
            border-radius: 6px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 6px;
        }
        
        .overall-progress {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .overall-progress-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }
        
        .overall-progress-bar {
            height: 12px;
            background: var(--border-color);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        
        .overall-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 6px;
        }
        
        .overall-progress-text {
            font-size: 0.9rem;
            color: var(--text-color);
        }
        
        .hint-info {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #856404;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .hint-info::before {
            content: "\f0eb";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #856404;
        }
        
        .favorite-info {
            background: #e8f4fc;
            border: 1px solid #bee5eb;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #0c5460;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .favorite-info::before {
            content: "\f004";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #0c5460;
        }
        
        .trainer-info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #0c5460;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .trainer-info::before {
            content: "\f303";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #0c5460;
        }
        
        .gold-info {
            background: #fff8e1;
            border: 1px solid #ffecb3;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #ff6f00;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .gold-info::before {
            content: "\f3e5";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #f39c12;
        }
        
        .explanation {
            background: #e8f5e9;
            border-left: 4px solid var(--success-color);
            padding: 15px;
            margin-top: 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            color: #2e7d32;
            display: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .explanation.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 200px; }
        }
        
        .achievements {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
        }
        
        .achievement {
            background: var(--education-card);
            border-radius: 50%;
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: var(--text-color);
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid var(--border-color);
        }
        
        .achievement:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .achievement.locked {
            opacity: 0.5;
            filter: grayscale(100%);
        }
        
        .achievement.unlocked {
            animation: unlockAchievement 1s ease;
        }
        
        @keyframes unlockAchievement {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .achievement-tooltip {
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            z-index: 10;
        }
        
        .achievement:hover .achievement-tooltip {
            opacity: 1;
        }
        
        .search-container {
            margin-bottom: 25px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 18px 25px;
            border-radius: 50px;
            border: 2px solid var(--border-color);
            font-size: 1rem;
            background: var(--card-bg);
            color: var(--text-color);
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .search-icon {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-color);
            font-size: 1.2rem;
        }
        
        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
            justify-content: center;
        }
        
        .category-btn {
            background: var(--education-card);
            border: 2px solid var(--border-color);
            border-radius: 25px;
            padding: 10px 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-color);
            font-weight: 600;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .category-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }
        
        .category-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .card-container {
            background: var(--education-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: center;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .card-container::before {
            content: "\f02d";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 3rem;
            opacity: 0.1;
            color: var(--primary-color);
        }
        
        .card-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .card-question {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 25px;
            color: var(--text-color);
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }
        
        .card-answer {
            font-size: 1.2rem;
            color: var(--text-color);
            opacity: 0;
            transition: opacity 0.5s ease;
            font-weight: 500;
            z-index: 1;
            position: relative;
        }
        
        .card-answer.show {
            opacity: 1;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s;
        }
        
        .modal-content {
            background-color: var(--card-bg);
            margin: 15% auto;
            padding: 30px;
            border-radius: 20px;
            width: 80%;
            max-width: 500px;
            text-align: center;
            animation: slideIn 0.5s;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .achievement-icon {
            font-size: 4rem;
            color: var(--accent-color);
            margin-bottom: 20px;
            animation: bounce 1s infinite alternate;
        }
        
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-15px); }
        }
        
        #confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            animation: confetti-fall 3s linear forwards;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .admin-panel {
            background: var(--education-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .admin-panel h3 {
            color: var(--primary-color);
            margin-top: 0;
            font-size: 1.3rem;
            position: relative;
            padding-left: 30px;
        }
        
        .admin-panel h3::before {
            content: "\f023";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 0;
            top: 2px;
            color: var(--primary-color);
        }
        
        .admin-panel input {
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
        }
        
        .stats-container {
            background: var(--education-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-color);
        }
        
        .no-stats {
            text-align: center;
            padding: 30px;
            color: var(--text-color);
            font-style: italic;
        }
        
        .stats-chart {
            margin-top: 20px;
            height: 200px;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            position: relative;
        }
        
        .chart-bar {
            position: absolute;
            bottom: 15px;
            width: 30px;
            background: linear-gradient(to top, var(--primary-color), var(--secondary-color));
            border-radius: 5px 5px 0 0;
            transition: height 0.5s ease;
        }
        
        .chart-label {
            position: absolute;
            bottom: -25px;
            font-size: 0.8rem;
            width: 30px;
            text-align: center;
        }
        
        .export-stats {
            margin-top: 20px;
            text-align: center;
        }
        
        .export-stats button {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            margin: 5px;
        }
        
        .export-stats button:hover {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
        }
        
        .install-guide {
            background: var(--education-card);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            transition: background-color 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .install-guide h3 {
            color: var(--primary-color);
            margin-top: 0;
            font-size: 1.3rem;
            position: relative;
            padding-left: 30px;
        }
        
        .install-guide h3::before {
            content: "\f3cd";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 0;
            top: 2px;
            color: var(--primary-color);
        }
        
        .install-guide ul {
            padding-left: 20px;
            line-height: 1.8;
            font-size: 1rem;
        }
        
        .install-guide li {
            margin-bottom: 10px;
        }
        
        .import-status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .import-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .import-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        /* Таблица лидеров */
        .leaderboard-container {
            background: var(--education-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .leaderboard-header {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .leaderboard-table th, .leaderboard-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .leaderboard-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        
        .leaderboard-table tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .leaderboard-table tr:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .leaderboard-rank {
            font-weight: bold;
            color: var(--accent-color);
        }
        
        .leaderboard-score {
            font-weight: bold;
            color: var(--success-color);
        }
        
        .leaderboard-date {
            font-size: 0.9rem;
            color: var(--text-color);
            opacity: 0.8;
        }
        
        .no-leaderboard {
            text-align: center;
            padding: 30px;
            color: var(--text-color);
            font-style: italic;
        }
        
        /* Форма обратной связи */
        .feedback-container {
            background: var(--education-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .feedback-header {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .feedback-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .feedback-form input, .feedback-form textarea {
            width: 100%;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
            font-family: inherit;
        }
        
        .feedback-form textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .feedback-form input:focus, .feedback-form textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .feedback-form label {
            font-weight: 600;
            color: var(--text-color);
        }
        
        .feedback-success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            display: none;
        }
        
        /* Адаптивность для альбомной ориентации */
        @media screen and (orientation: landscape) and (max-height: 600px) {
            .container {
                max-width: 1200px;
                padding: 20px;
                margin: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
                margin-bottom: 15px;
            }
            
            .question-container, .gold-question-container {
                padding: 20px;
                margin-bottom: 15px;
            }
            
            .question {
                font-size: 1.1rem;
                margin-bottom: 15px;
                padding-left: 30px;
            }
            
            .question::before {
                font-size: 1.2rem;
            }
            
            .option {
                padding: 12px;
                font-size: 0.9rem;
                min-height: 50px;
            }
            
            .btn {
                padding: 14px 18px;
                font-size: 0.95rem;
                margin: 8px 0;
            }
            
            .timer {
                font-size: 1.1rem;
                padding: 10px;
                margin-bottom: 15px;
            }
            
            .ticket-info {
                font-size: 0.95rem;
                padding: 10px;
                margin-bottom: 15px;
            }
            
            .progress-bar {
                height: 10px;
                margin-bottom: 15px;
            }
            
            .result {
                padding: 15px;
            }
            
            .result h2 {
                font-size: 1.4rem;
                margin-bottom: 15px;
            }
            
            .result-score {
                font-size: 2.2rem;
                margin: 15px 0;
            }
            
            .result-message {
                font-size: 1rem;
                margin-bottom: 20px;
            }
            
            .achievements {
                margin: 15px 0;
            }
            
            .achievement {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .install-guide {
                margin-top: 20px;
                padding: 20px;
            }
        }
        
        /* Адаптивность для портретной ориентации */
        @media screen and (orientation: portrait) and (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 15px;
                border-radius: 15px;
            }
            
            h1 {
                font-size: 1.6rem;
                margin-bottom: 15px;
            }
            
            .question-container, .gold-question-container {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .question {
                font-size: 1.1rem;
                margin-bottom: 20px;
                padding-left: 25px;
            }
            
            .question::before {
                font-size: 1.2rem;
            }
            
            .option {
                padding: 12px;
                font-size: 0.9rem;
                min-height: 50px;
            }
            
            .btn {
                padding: 14px 18px;
                font-size: 0.95rem;
                margin: 8px 0;
            }
            
            .timer {
                font-size: 1.1rem;
                padding: 10px;
                margin-bottom: 15px;
            }
            
            .ticket-info {
                font-size: 0.95rem;
                padding: 10px;
                margin-bottom: 15px;
            }
            
            .progress-bar {
                height: 10px;
                margin-bottom: 15px;
            }
            
            .result {
                padding: 15px;
            }
            
            .result h2 {
                font-size: 1.4rem;
                margin-bottom: 15px;
            }
            
            .result-score {
                font-size: 2.2rem;
                margin: 15px 0;
            }
            
            .result-message {
                font-size: 1rem;
                margin-bottom: 20px;
            }
        }
        
        /* Адаптивность для планшетов в альбомной ориентации */
        @media screen and (orientation: landscape) and (min-width: 768px) and (max-width: 1024px) {
            .container {
                max-width: 1000px;
                padding: 25px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .leaderboard-table {
                font-size: 0.9rem;
            }
            
            .leaderboard-table th, .leaderboard-table td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
            <i class="fas fa-moon"></i>
        </button>
        
        <h1><i class="fas fa-book-open"></i> Подготовка по технике безопасности</h1>
        
        <!-- Начальный экран -->
        <div id="startScreen" class="screen active">
            <div style="text-align: center; margin: 30px 0;">
                <p style="font-size: 1.2rem; margin-bottom: 30px; color: var(--text-color); font-weight: 500;">
                    Выберите режим:
                </p>
                <button class="btn" onclick="startTraining()"><i class="fas fa-graduation-cap"></i> Режим обучения</button>
                <button class="btn btn-exam" onclick="startExam()"><i class="fas fa-file-alt"></i> Пройти экзамен</button>
                <button class="btn btn-restart hidden-mode" onclick="startTrainer()"><i class="fas fa-redo"></i> Тренажер ошибок</button>
                <button class="btn btn-cards hidden-mode" onclick="startCards()"><i class="fas fa-clone"></i> Карточки</button>
                <button class="btn btn-gold" onclick="startGoldRules()"><i class="fas fa-medal"></i> Золотые правила</button>
                <button class="btn btn-leaderboard" onclick="startLeaderboard()"><i class="fas fa-trophy"></i> Таблица лидеров</button>
                <button class="btn btn-feedback" onclick="startFeedback()"><i class="fas fa-comment-dots"></i> Предложить улучшение</button>
                <button class="btn btn-admin" onclick="showAdminModal()"><i class="fas fa-user-shield"></i> Администратор</button>
            </div>
            
            <div class="achievements">
                <div class="achievement" id="achievement1">
                    <i class="fas fa-star"></i>
                    <div class="achievement-tooltip">Новичок</div>
                </div>
                <div class="achievement locked" id="achievement2">
                    <i class="fas fa-fire"></i>
                    <div class="achievement-tooltip">Стремительный</div>
                </div>
                <div class="achievement locked" id="achievement3">
                    <i class="fas fa-trophy"></i>
                    <div class="achievement-tooltip">Эксперт</div>
                </div>
                <div class="achievement locked" id="achievement4">
                    <i class="fas fa-medal"></i>
                    <div class="achievement-tooltip">Мастер</div>
                </div>
                <div class="achievement locked" id="achievement5">
                    <i class="fas fa-crown"></i>
                    <div class="achievement-tooltip">Золотой мастер</div>
                </div>
            </div>
            
            <div style="background: var(--education-card); padding: 25px; border-radius: 15px; margin-top: 30px; transition: background-color 0.3s ease; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);">
                <h3 style="color: var(--primary-color); margin-top: 0; font-size: 1.3rem; position: relative; padding-left: 30px;">
                    <i class="fas fa-info-circle" style="position: absolute; left: 0; top: 2px; color: var(--primary-color);"></i>
                    Информация:
                </h3>
                <ul style="padding-left: 20px; line-height: 1.8; font-size: 1rem;">
                    <li><i class="fas fa-check-circle" style="color: var(--secondary-color); margin-right: 8px;"></i>Режим обучения: это 63 вопроса без ограничения времени</li>
                    <li><i class="fas fa-check-circle" style="color: var(--secondary-color); margin-right: 8px;"></i>Экзамен: это 30 минут, случайный билет (10 или 13 вопросов)</li>
                    <li><i class="fas fa-check-circle" style="color: var(--secondary-color); margin-right: 8px;"></i>Золотые правила: тестирование по ключевым требованиям безопасности</li>
                    <li><i class="fas fa-check-circle" style="color: var(--secondary-color); margin-right: 8px;"></i>Ухпп ЦЕХ № 4</li>
                </ul>
            </div>
            
            <div class="install-guide">
                <h3>Установка на телефон</h3>
                <ul>
                    <li><i class="fab fa-android" style="color: var(--secondary-color); margin-right: 8px;"></i><strong>Android:</strong> В Chrome нажмите на меню (три точки) → "Добавить на главный экран"</li>
                    <li><i class="fab fa-apple" style="color: var(--secondary-color); margin-right: 8px;"></i><strong>iOS:</strong> В Safari нажмите на кнопку "Поделиться" → "На главный экран"</li>
                    <li><i class="fas fa-info-circle" style="color: var(--primary-color); margin-right: 8px;"></i>.</li>
                </ul>
            </div>
        </div>
        
        <!-- Экран обучения -->
        <div id="trainingScreen" class="screen">
            <div class="hint-info" id="hintInfo">Подсказок осталось: 3</div>
            
            <!-- Индикатор общего прогресса -->
            <div class="overall-progress">
                <div class="overall-progress-label">Общий прогресс</div>
                <div class="overall-progress-bar">
                    <div class="overall-progress-fill" id="overallProgressFill"></div>
                </div>
                <div class="overall-progress-text" id="overallProgressText">0%</div>
            </div>
            
            <div class="progress-bar">
                <div class="progress" id="trainingProgress"></div>
            </div>
            
            <div class="question-container">
                <div class="question" id="trainingQuestion"></div>
                <div class="options" id="trainingOptions"></div>
                <div class="explanation" id="trainingExplanation"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-hint" id="hintBtn" onclick="useHint()"><i class="fas fa-lightbulb"></i> Использовать подсказку</button>
                <button class="btn btn-favorite" id="favoriteBtn" onclick="toggleFavorite()"><i class="fas fa-star"></i> Добавить в избранное</button>
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран экзамена -->
        <div id="examScreen" class="screen">
            <div class="timer" id="examTimer">Осталось времени: 30:00</div>
            <div class="ticket-info" id="ticketInfo"></div>
            
            <div class="progress-bar">
                <div class="progress" id="examProgress"></div>
            </div>
            
            <div class="question-container">
                <div class="question" id="examQuestion"></div>
                <div class="options" id="examOptions"></div>
                <div class="explanation" id="examExplanation"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран результатов -->
        <div id="resultScreen" class="screen">
            <div class="result">
                <h2><i class="fas fa-chart-line"></i> Результаты экзамена</h2>
                <div class="result-score" id="resultScore">0%</div>
                <div class="result-message" id="resultMessage"></div>
                <button class="btn btn-restart" onclick="backToStart()"><i class="fas fa-redo"></i> Пройти заново</button>
            </div>
        </div>
        
        <!-- Экран избранных вопросов -->
        <div id="favoritesScreen" class="screen">
            <div class="favorite-info">Избранные вопросы: <span id="favoritesCount">0</span></div>
            
            <div class="progress-bar">
                <div class="progress" id="favoritesProgress"></div>
            </div>
            
            <div class="question-container">
                <div class="question" id="favoritesQuestion"></div>
                <div class="options" id="favoritesOptions"></div>
                <div class="explanation" id="favoritesExplanation"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран тренажера -->
        <div id="trainerScreen" class="screen hidden-mode">
            <div class="trainer-info">Вопросы с ошибками: <span id="trainerCount">0</span></div>
            
            <div class="progress-bar">
                <div class="progress" id="trainerProgress"></div>
            </div>
            
            <div class="question-container">
                <div class="question" id="trainerQuestion"></div>
                <div class="options" id="trainerOptions"></div>
                <div class="explanation" id="trainerExplanation"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран поиска -->
        <div id="searchScreen" class="screen">
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Поиск по ключевым словам..." onkeyup="searchQuestions()">
                <i class="fas fa-search search-icon"></i>
            </div>
            
            <div class="category-filter" id="categoryFilter">
                <button class="category-btn active" onclick="filterByCategory('all')">Все категории</button>
                <button class="category-btn" onclick="filterByCategory('Первая помощь')">Первая помощь</button>
                <button class="category-btn" onclick="filterByCategory('Оборудование')">Оборудование</button>
                <button class="category-btn" onclick="filterByCategory('Безопасность')">Безопасность</button>
                <button class="category-btn" onclick="filterByCategory('Химия')">Химия</button>
            </div>
            
            <div id="searchResults" class="stats-container">
                <div class="no-stats">Введите ключевые слова для поиска</div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран карточек -->
        <div id="cardsScreen" class="screen hidden-mode">
            <div class="card-container">
                <div class="card-question" id="cardQuestion">Нажмите "Далее" для начала</div>
                <div class="card-answer" id="cardAnswer"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" id="cardBtn" onclick="nextCard()"><i class="fas fa-arrow-right"></i> Далее</button>
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран Золотых правил -->
        <div id="goldRulesScreen" class="screen">
            <div class="gold-info">Золотые правила безопасности труда: <span id="goldRulesCount">32</span> вопросов</div>
            
            <div class="progress-bar">
                <div class="progress" id="goldRulesProgress"></div>
            </div>
            
            <div class="gold-question-container">
                <div class="question gold-question" id="goldRulesQuestion"></div>
                <div class="options" id="goldRulesOptions"></div>
                <div class="explanation" id="goldRulesExplanation"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-favorite" id="goldRulesFavoriteBtn" onclick="toggleGoldRulesFavorite()"><i class="fas fa-star"></i> Добавить в избранное</button>
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран таблицы лидеров -->
        <div id="leaderboardScreen" class="screen">
            <div class="leaderboard-container">
                <div class="leaderboard-header"><i class="fas fa-trophy"></i> Таблица лидеров</div>
                
                <div id="leaderboardContent">
                    <div class="no-leaderboard">Загрузка таблицы лидеров...</div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран обратной связи -->
        <div id="feedbackScreen" class="screen">
            <div class="feedback-container">
                <div class="feedback-header"><i class="fas fa-comment-dots"></i> Предложить улучшение</div>
                
                <form class="feedback-form" id="feedbackForm">
                    <div>
                        <label for="feedbackName">Ваше имя (необязательно):</label>
                        <input type="text" id="feedbackName" placeholder="Введите ваше имя">
                    </div>
                    
                    <div>
                        <label for="feedbackEmail">Email (необязательно):</label>
                        <input type="email" id="feedbackEmail" placeholder="your.email@example.com">
                    </div>
                    
                    <div>
                        <label for="feedbackMessage">Ваше предложение:</label>
                        <textarea id="feedbackMessage" placeholder="Опишите ваше предложение по улучшению приложения..." required></textarea>
                    </div>
                    
                    <button type="submit" class="btn"><i class="fas fa-paper-plane"></i> Отправить</button>
                </form>
                
                <div class="feedback-success" id="feedbackSuccess">
                    <i class="fas fa-check-circle"></i> Спасибо! Ваше предложение отправлено.
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
        
        <!-- Экран администратора -->
        <div id="adminScreen" class="screen">
            <div class="admin-panel">
                <h3>Панель администратора</h3>
                <p style="margin-bottom: 20px;">Импортируйте новые вопросы в формате JSON</p>
                
                <div style="margin-bottom: 20px;">
                    <label for="importFile" class="btn" style="display: inline-block; width: auto; margin: 0;">
                        <i class="fas fa-file-import"></i> Выбрать файл
                    </label>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importQuestions(event)">
                </div>
                
                <div id="importStatus" style="display: none;"></div>
                
                <button class="btn" onclick="exportQuestions()"><i class="fas fa-file-export"></i> Экспортировать вопросы</button>
                <button class="btn" onclick="resetQuestions()" style="background: linear-gradient(45deg, var(--danger-color), #c0392b);"><i class="fas fa-trash-alt"></i> Сбросить все вопросы</button>
            </div>
            
            <div class="stats-container">
                <h3>Статистика использования приложения</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalLaunches">0</div>
                        <div class="stat-label">Всего запусков</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalTime">0ч 0м</div>
                        <div class="stat-label">Общее время</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgTime">0ч 0м</div>
                        <div class="stat-label">Среднее время</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="lastLaunch">-</div>
                        <div class="stat-label">Последний запуск</div>
                    </div>
                </div>
                
                <div class="stats-chart" id="usageChart">
                    <!-- График будет создан динамически -->
                </div>
                
                <div class="export-stats">
                    <button class="btn" onclick="exportStats()"><i class="fas fa-download"></i> Экспорт статистики</button>
                    <button class="btn" onclick="resetStats()" style="background: linear-gradient(45deg, var(--danger-color), #c0392b);"><i class="fas fa-trash-alt"></i> Сбросить статистику</button>
                </div>
            </div>
            
            <div class="stats-container">
                <h3>Предложения пользователей</h3>
                <div id="feedbackList">
                    <div class="no-stats">Нет предложений</div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="backToStart()"><i class="fas fa-arrow-left"></i> Вернуться в меню</button>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно для входа администратора -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <h2>Доступ администратора</h2>
            <input type="password" id="adminPassword" placeholder="Введите пароль" class="search-input">
            <button class="btn" onclick="checkAdminPassword()">Войти</button>
            <button class="btn" onclick="closeAdminModal()">Отмена</button>
        </div>
    </div>
    
    <!-- Модальное окно для имени пользователя -->
    <div id="nameModal" class="modal">
        <div class="modal-content">
            <h2>Введите ваше имя</h2>
            <input type="text" id="userName" placeholder="Ваше имя" class="search-input">
            <button class="btn" onclick="saveUserName()">Сохранить</button>
        </div>
    </div>
    
    <!-- Модальное окно для достижений -->
    <div id="achievementModal" class="modal">
        <div class="modal-content">
            <div class="achievement-icon">
                <i class="fas fa-trophy"></i>
            </div>
            <h2>Получено достижение!</h2>
            <p id="achievementName">Название достижения</p>
            <p id="achievementDescription">Описание достижения</p>
            <button class="btn" onclick="closeAchievementModal()">Отлично!</button>
        </div>
    </div>
    
    <!-- Контейнер для конфетти -->
    <div id="confetti-container"></div>
    
    <script>
        // Все вопросы из документа с категориями и объяснениями
        let questions = [
            {
                question: "Первая помощь пострадавшему от электрического тока если пострадавший в сознании",
                options: [
                    "Пульс на сонной артерии прощупывают подушечками второго, третьего и четвертого пальцев руки, располагая их вдоль шеи между кадыком (адамово яблоком) и кивательной мышцей и слегка прижимая к позвоночнику. Приемы определения пульса на сонной артерии очень легко отработать на себе или на своих близких",
                    "Если пострадавший в сознании, но до этого был в обмороке или находился в бессознательном состоянии, но с сохранившимися устойчивыми дыханием и пульсом, его следует уложить на подстилку, например, из одежды; расстегнуть одежду, стесняющую дыхание; создать приток свежего воздуха; согреть тело, если холодно; обеспечить прохладу, если жарко; создать полный покой, непрерывно наблюдая за пульсом и дыханием; удалить лишних людей.",
                    "Если у пострадавшего отсутствуют сознание, дыхание, пульс, кожный покров синюшный, а зрачки широкие (0,5 см в диаметре), можно считать, что он находится в состоянии клинической смерти, и немедленно приступать к реанимационным мероприятиям с помощью искусственного дыхания по способу «изо рта в рот» или «изо рта в нос» и наружного массажа сердца. Не следует раздевать пострадавшего, теряя драгоценные секунды"
                ],
                correct: 1,
                category: "Первая помощь",
                explanation: "Правильный ответ: Если пострадавший в сознании... Объяснение: Важно обеспечить полный покой и наблюдение за состоянием, так как даже после кажущегося улучшения возможны осложнения."
            },
            {
                question: "Дайте определения понятию первая помощь?",
                options: [
                    "Первая помощь - это простейшие медицинские действия, выполняемые непосредственно на месте происшествия, в кратчайшие сроки после травмы. Она оказывается, как правило, не медиками, а работником, находящимся в момент происшествия непосредственно на месте происшествия или вблизи от него. Считается оптимальным сроком оказания первой помощи - 30 минут после травмы.",
                    "Первая помощь до оказания медицинской помощи оказывается гражданам при несчастных случаях, травмах, отравлениях и других состояниях и заболеваниях, угрожающих их жизни и здоровью, лицами, обязанными оказывать первую помощь в соответствии с федеральным законом или со специальным правилом и имеющими соответствующую подготовку, в том числе сотрудниками органов внутренних дел РФ, сотрудниками, военнослужащими и работниками государственной противопожарной службы, спасателями аварийно-спасательных формирований и аварийно-спасательных служб"
                ],
                correct: 0,
                category: "Первая помощь",
                explanation: "Правильный ответ: Первая помощь - это простейшие медицинские действия... Объяснение: Ключевой аспект - оказание помощи непосредственно на месте происшествия в кратчайшие сроки."
            },
            {
                question: "Первая помощь при артериальном кровотечении?",
                options: [
                    "положить пострадавшего так, чтобы рана находилась выше уровня сердца. Логично, чисто физически кровь будет меньше литься , зажать артерию выше места повреждения, наложить жгут выше разрыва. Необходимо чтобы артерия прижалась к кости и престала литься кровь. Это возможно на бедре и плече. Поэтому если фонтанчик идет из пальца, все равно накладываем жгут на плечо, обязательно пишем на бумажке время наложения жгута и подкладываем под жгут, если он будет долго находится, возможно отмирание тканей, что может стоить человеку конечности или жизни, транспортируем пострадавшего в ближайшую больницу",
                    "При обнаружении признаков артериального кровотечения желательно задействовать двух человек для оказания помощи. Первый должен прижать поврежденный кровеносный сосуд пальцем. Для этого нужно найти место, где артерия проходит над костью. Второй человек в это время готовит средства для более продолжительной остановки крови. Давящую повязку можно использовать только в случае ранения мелких артерий (пальцевых, ладонных, плюсневых). Остановить кровотечение из более крупного сосуда можно, наложив жгут. При ранении конечности эффективным кровоостанавливающим действием будет сгибание сустава с максимальным усилием. Если человек находится в сознании, он может сделать это сам. Окружающим нужно лишь придерживать руку или ногу в нужном положении или усиливать давление. При потере сознания (что для артериального кровотечения характерно) в область сустава накладывают бинт, а саму конечность в согнутой позиции фиксируют ремнем. Записать время наложения жгута. Ослаблять его каждые 10-15 минут во избежание изменений в тканях. Если пострадавший стабилен, зафиксировать раненую конечность в удобном положении. При обильной кровопотере уложить пострадавшего на спину и высоко приподнять его ноги (на 30-40 см), используя подушку или связку одежды. В случае потери сознания убедиться в наличии признаков жизни и перевернуть на бок (если обеспечивается устойчивое положение тела) или на живот. Важно держать под контролем пульс и дыхание человека. При их отсутствии нужно немедленно приступать к сердечно-легочной реанимации. Главная задача оказания помощи своими силами — сохранить раненому жизнь до приезда врачей."
                ],
                correct: 1,
                category: "Первая помощь",
                explanation: "Правильный ответ: При обнаружении признаков артериального кровотечения... Объяснение: Важно задействовать двух человек: один прижимает сосуд, другой готовит средства для остановки крови. Ключевые моменты: наложение жгута с фиксацией времени, контроль пульса и дыхания."
            },
            {
                question: "Перечислить 3 стадии общего переохлаждения?",
                options: [
                    "АДИНАМИЧЕСКАЯ, СТУПОРОЗНАЯ, СУДОРОЖНАЯ ИЛИ КОМАТОЗНАЯ",
                    "легкая, средней тяжести, тяжелая.",
                    "Все вышеперечисленное",
                    "I степень – ознобление, II степень – образование пузырей, III степень – некроз кожи"
                ],
                correct: 1,
                category: "Первая помощь",
                explanation: "Правильный ответ: легкая, средней тяжести, тяжелая. Объяснение: Стадии переохлаждения классифицируются по тяжести состояния: легкая (дрожь, бледность), средней тяжести (сонливость, нарушение координации), тяжелая (потеря сознания, остановка дыхания)."
            },
            {
                question: "Первые симптомы при укусе змеи?",
                options: [
                    "Зуд, боли, невралгических болей по ходу ближайших к месту укуса нервных путей. Больные испытывают беспричинный страх, тоску, тревогу, появляются повышенная чувствительность к звуковым и световым раздражителям, резко повышается температура.",
                    "ушиб, разрыв, размозжение тканей, а также обильное обсеменение микробной микрофлорой, содержащейся в слюне. Возможно заражение бешенством",
                    "Стадия возбуждения – длится от 4 до 7 дней и проявляется периодическими приступами психомоторного возбуждения. Выражаются в резко повышенной чувствительности к малейшим раздражителям органов чувств: яркий свет, различные звуки, шум. Больные становятся агрессивными, буйными, появляются галлюцинации, бред, чувство страха, появляются судороги, парезы и параличи мышц. Стадия возбуждения, как правило, сопровождается лихорадкой до 400 С"
                ],
                correct: 0,
                category: "Первая помощь",
                explanation: "Правильный ответ: Зуд, боли, невралгических болей... Объяснение: При укусе змеи характерны местные симптомы (зуд, боль) и общие реакции (страх, тревога, светочувствительность, повышение температуры)."
            },
            {
                question: "На какие степени по глубине поражения делятся ожоги?",
                options: [
                    "покраснение и отек кожи",
                    "водяные пузыри",
                    "омертвение поверхностных и глубоких слоев кожи",
                    "обугливание кожи, поражение мышц, сухожилий и костей",
                    "Все вышеперечисленное.",
                    "Ответ 2,1,4"
                ],
                correct: 4,
                category: "Первая помощь",
                explanation: "Правильный ответ: Все вышеперечисленное. Объяснение: Ожоги классифицируются по 4 степеням: I - покраснение, II - пузыри, III - некроз кожи, IV - обугливание с поражением глубоких тканей."
            },
            {
                question: "Первая помощь при обмороке, тепловом и солнечных ударах и отравлениях?",
                options: [
                    "Необходимо расстегнуть одежду пострадавшего, стесняющую дыхание, обеспечить приток свежего воздуха, дать ему выпить холодной воды, давать нюхать нашатырный спирт. Класть на голову холодные примочки и лед не следует. Лицо и грудь можно смочить холодной водой. Так же следует поступать, если обморок уже наступил",
                    "пострадавшего необходимо вывести или вынести из жаркого помещения или удалить с солнцепека в тень, прохладное помещение, обеспечив приток свежего воздуха. Его следует уложить так, чтобы голова была выше туловища, расстегнуть одежду, стесняющую дыхание, положить на голову лед или делать холодные примочки, смочить грудь холодной водой, давать нюхать нашатырный спирт. Если пострадавший в сознании, нужно дать ему выпить 15-20 капель настойки валерианы на 1/3 стакана воды",
                    "вывести или вынести пострадавшего из отравленной зоны, расстегнуть одежду, стесняющую дыхание, обеспечить приток свежего воздуха, уложить его, приподняв ноги, укрыть потеплее, давать нюхать нашатырный спирт",
                    "Все вышеперечисленное."
                ],
                correct: 3,
                category: "Первая помощь",
                explanation: "Правильный ответ: Все вышеперечисленное. Объяснение: При обмороке, тепловом ударе и отравлениях общие принципы помощи: обеспечить доступ свежего воздуха, уложить пострадавшего, расстегнуть одежду, использовать нашатырный спирт."
            },
            {
                question: "Радиус опасной зоны при проведении пропарочных работ ППУА-1600\\100?",
                options: [
                    "проведения пропарочных работ в радиусе - не менее 50м. Место проведения пропарочных работ обозначить знаками «ОСТОРОЖНО! ТЕПЛОВАЯ ОБРАБОТКА».",
                    "проведения пропарочных работ в радиусе - не менее 25м. Место проведения пропарочных работ обозначить знаками «ОСТОРОЖНО! ТЕПЛОВАЯ ОБРАБОТКА»",
                    "проведения пропарочных работ в радиусе - не менее 40м. Место проведения пропарочных работ обозначить знаками «ОСТОРОЖНО! ТЕПЛОВАЯ ОБРАБОТКА»",
                    "проведения пропарочных работ в радиусе - не менее 10м. Место проведения пропарочных работ обозначить знаками «ОСТОРОЖНО! ТЕПЛОВАЯ ОБРАБОТКА»"
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: проведения пропарочных работ в радиусе - не менее 50м... Объяснение: Безопасное расстояние при работе с ППУА-1600/100 должно быть не менее 50 метров с обязательным обозначением зоны знаками безопасности."
            },
            {
                question: "Чем должна быть укомплектована установка промысловая паровая передвижная ППУА-1600\\100",
                options: [
                    "ППУ должна быть укомплектована сертифицированным искрогасителем, средствами пожаротушения, противооткатными башмаками. ППУ должна быть укомплектована исправной гибкой линией, магистральными паровыми трубами для проведения термических обработок скважин горячим паром путём «жёсткого» подключения (обеспечить наличие обратного клапана) и металлическим наконечником, который должен быть длиною 1500-2000 мм и внутренним диаметром 20 - 25 мм, при этом должна быть обеспечена исправность резьбовых соединений и надежность крепления термостойкого шланга к металлическому наконечнику (пистолету) специальными хомутами.",
                    "ППУ должна быть укомплектована сертифицированным искрогасителем, средствами пожаротушения, противооткатными башмаками. ППУ должна быть укомплектована исправной гибкой линией, магистральными паровыми трубами для проведения термических обработок скважин горячим паром путём «жёсткого» подключения (обеспечить наличие обратного клапана) и металлическим наконечником, который должен быть длиною 500-1000 мм и внутренним диаметром 20 - 25 мм, при этом должна быть обеспечена исправность резьбовых соединений и надежность крепления термостойкого шланга к металлическому наконечнику (пистолету) специальными хомутами"
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: ППУ должна быть укомплектована... Объяснение: Ключевые требования: искрогаситель, средства пожаротушения, противооткатные башмаки, гибкая линия, металлический наконечник длиной 1500-2000 мм."
            },
            {
                question: "На каком расстояние от действующих резервуаров должна размещаться ППУА1600\\100?",
                options: [
                    "25 метров",
                    "40 метров.",
                    "50 метров",
                    "30 метров"
                ],
                correct: 1,
                category: "Оборудование",
                explanation: "Правильный ответ: 40 метров. Объяснение: Безопасное расстояние размещения ППУА-1600/100 от действующих резервуаров должно составлять не менее 40 метров для предотвращения аварийных ситуаций."
            },
            {
                question: "Действие работника по окончанию работ при помощи установки промысловой паровой передвижной ППУА-1600\\100?",
                options: [
                    "подать установленный сигнал машинисту установки (в случае необходимости через сигнальщика) на прекращение подачи пара; остановить работу ППУ; снизить давление в паропроводе до атмосферного; дождаться полного остывания паропроводов; разобрать паропровод; уложить в транспортное положение паропровод и закрепить на автомобиле; убрать замазученность на месте производства работ; доложить специалисту, ответственному за безопасное производство работ и (или) своему непосредственному руководителю, специалисту о выполненной работе.",
                    "подать установленный сигнал машинисту установки (в случае необходимости через сигнальщика) на прекращение подачи пара; остановить работу ППУ; разобрать паропровод; уложить в транспортное положение паропровод и закрепить на автомобиле;доложить специалисту, ответственному за безопасное производство работ и (или) своему непосредственному руководителю, специалисту о выполненной работе"
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: подать установленный сигнал... Объяснение: Важные шаги: остановка подачи пара, снижение давления, остывание оборудования, разборка паропровода, уборка рабочего места, доклад руководителю."
            },
            {
                question: "Что необходимо проверить перед началом производства работ по проведению паротепловых обработок?",
                options: [
                    "наличие специальной одежды, специальной обуви, маски защитной, каски защитной, рукавиц, их соответствие установленным нормам выдачи СИЗ, исправность резьбовых соединений; надежность крепления термостойкого шланга специальными хомутами.",
                    "укомплектованность и исправность гибкой линии, магистральных паровых труб и фланцевых присоединений для проведения термических обработок скважин горячим паром путём «жёсткого» подключения и металлическим наконечником, который должен быть длиною 1500-2000 мм и внутренним диаметром 20 - 25 мм; предупредительный знак: «ОСТОРОЖНО! ТЕПЛОВАЯ ОБРАБОТКА»; защитный экран сферической или квадратной формы, со стороной квадрата (круга) не менее 500 мм, выполненного из мягкого листового железа, оборудованного посредине экрана отверстием под металлический наконечник термостойкого шланга"
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: наличие специальной одежды... Объяснение: Перед началом работ необходимо проверить СИЗ, исправность соединений и креплений. Это основа безопасности при проведении паротепловых обработок."
            },
            {
                question: "В каких случаях паровая установка должна быть немедленно остановлена и работы на ней прекращены?",
                options: [
                    "при возникновении пожара на установке; при прорыве технологических трубопроводов; при обнаружении неполадок в трансмиссиях привода оборудования (обрыв ремня, стуки в насосах, редукторе и т.п.)",
                    "нарушения нормальной работы систем установки, влияющих на безопасность работников, при выявлении неисправности гибкой линии; при разгерметизации магистральных паровых труб и",
                    "Вышеперечисленное.",
                    "Нет правильного ответа"
                ],
                correct: 2,
                category: "Оборудование",
                explanation: "Правильный ответ: Вышеперечисленное. Объяснение: Паровая установка должна быть остановлена при любом из перечисленных случаев: пожар, прорыв трубопроводов, неисправности оборудования, разгерметизация."
            },
            {
                question: "Какой основной способ блокировки должен использоваться для отключения горючих и инертных газов,горючих и агрессивных жидкостей в первую очередь?",
                options: [
                    "Для отключения горючих и инертных газов, горючих и агрессивных жидкостей в первую очередь должен быть использован основной способ блокировки: должены быть штатные заглушки, с соответствующими записями об установке, при подготовке, и снятию их, при окончании работ по ремонту и техническому обслуживанию технологического оборудования.",
                    "Для отключения горючих и инертных газов, горючих и агрессивных жидкостей в первую очередь должен быть использован основной способ блокировки: не штатные заглушки, с соответствующими записями об установке, при подготовке, и снятию их, при окончании работ"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Для отключения горючих и инертных газов... Объяснение: Основной способ блокировки - использование штатных заглушек с обязательным документальным оформлением установки и снятия."
            },
            {
                question: "Кто имеет доступ к месту для хранения блокираторов, замков и вспомогательного оборудования?",
                options: [
                    "Доступ к шкафу для хранения блокираторов, замков и вспомогательного оборудования имеют начальник (заместитель начальника) цеха (участка), механник, мастер, производственного объекта, которые должны выдавать устройства, внося информацию в «Журнал учета выдачи блокираторов и замков",
                    "Доступ к шкафу для хранения блокираторов, замков и вспомогательного оборудования имеют начальник (заместитель начальника) цеха (участка), производственного объекта, которые должны выдавать устройства, внося информацию в «Журнал учета выдачи блокираторов и замков."
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: Доступ к шкафу для хранения... Объяснение: Доступ ограничен ответственными лицами: начальник цеха и его заместитель, которые ведут журнал учета выдачи блокирующих устройств."
            },
            {
                question: "Какая документация должна хранится на постах хранения блокирующих устройств",
                options: [
                    "Журнал учета выдачи замков, Журнал передачи ключей по смене, Журнал использования Мастер-ключа",
                    "Журнал учета выдачи блокираторов и замков, Журнал передачи ключей по смене, Журнал использования Мастер-ключа, Памятки по применению блокирующих устройств и проектов (планов) блокировки, отключения оборудования и его элементов."
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: Журнал учета выдачи блокираторов и замков... Объяснение: Полный комплект документации включает журналы учета, передачи ключей, использование мастер-ключа и памятки по применению блокирующих устройств."
            },
            {
                question: "Как функционально различаются блокировочные навесные замки?",
                options: [
                    "Для облегчения идентификации блокировочные навесные замки функционально разделены по службам и назначению",
                    "Для облегчения идентификации блокировочные навесные замки функционально разделены по цветовой гамме – по службам и назначению.",
                    "Для облегчения идентификации блокировочные навесные замки функционально разделены по цветовой гамме"
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: Для облегчения идентификации... Объяснение: Блокировочные замки различаются по цветовой гамме, что позволяет быстро определить принадлежность к конкретной службе и назначению."
            },
            {
                question: "Для облегчения идентификации блокировочные навесные замки функционально разделены по цветовой гамме",
                options: [
                    "на месте производства работ по перемещению грузов кранами-манипуляторами не допускается нахождение работников, не имеющих прямого отношения к выполняемой работе",
                    "обеспечение безопасных расстояний от сети и воздушных линий электропередачи, а также безопасных расстояний приближения кранов-манипуляторов к строениям и местам складирования строительных деталей и материалов",
                    "условия установки и работы кранов–манипуляторов вблизи откосов котлованов",
                    "Все вышеперечисленное",
                    "при необходимости осмотра, ремонта, регулировки механизмов, осмотра и ремонта металлоконструкций крана-манипулятора должен быть отключен двигатель",
                    "Ответ 1,2,3,5.",
                    "Нет правильного ответа"
                ],
                correct: 5,
                category: "Безопасность",
                explanation: "Правильный ответ: Ответ 1,2,3,5. Объяснение: Требования безопасности при работе с кранами-манипуляторами включают: запрет нахождения посторонних лиц, обеспечение безопасных расстояний, условия установки у котлованов, отключение двигателя при ремонте."
            },
            {
                question: "Что включают в себя подготовительные работы перед проведением огневых работ на временных местах?",
                options: [
                    "Подготовка объекта к проведению на нем огневых работ, остановить работающее оборудование; перекрыть запорную арматуру на приеме и выходе; освободить трубопроводы от избыточного давления; освободить от взрывоопасных, взрывопожароопасных, пожароопасных и токсичных продуктов, промыть, при необходимости пропарить, загерметизировать (перекрыть) места возможного поступления вредных/ горючих паров и газов, очистить, до отсутствия взрывопожароопасных веществ, подтвержденных анализом воздушной среды, закрыть негорючими материалами все смотровые, технологические и другие люки (лючки), вентиляционные, монтажные и другие проемы, защитить металлическим экраном, покрывалами или другими негорючими материалами."
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Подготовка объекта к проведению... Объяснение: Подготовка включает остановку оборудования, перекрытие арматуры, сброс давления, очистку от опасных веществ, герметизацию, защиту проемов негорючими материалами."
            },
            {
                question: "На какие виды подразделяются ремонтные работы?",
                options: [
                    "плановые ремонтные работы; внеплановые (неплановые) ремонтные работы; аварийно-восстановительные ремонтные работы.",
                    "ремонтные работы; внеплановые (неплановые) ремонтные работы; аварийно-восстановительные ремонтные работы"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: плановые ремонтные работы; внеплановые... Объяснение: Ремонтные работы классифицируются на плановые (по графику), внеплановые (непредвиденные) и аварийно-восстановительные (после аварий)."
            },
            {
                question: "Какую маркировку должна иметь запорная арматура?",
                options: [
                    "наименование или товарный знак завода-изготовителя; условный проход, мм; условное давление, МПа (кгс/см2); направление потока среды в соответствии с маркировкой на корпусе запорной арматуры; марку материала корпуса."
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: наименование или товарный знак... Объяснение: Запорная арматура должна иметь маркировку с указанием производителя, условного прохода, давления, направления потока и материала корпуса."
            },
            {
                question: "Какие требования необходимо выполнять перед монтажом запорной арматуры?",
                options: [
                    "снять заглушки; расконсервировать запорную арматуру; заменить сальниковую набивку; при закрытом клиновым затворе очистить проходы от возможных загрязнений; очистить трубопровод от загрязнений, хорошо его закрепить; обеспечить полное совпадение болтовых отверстий фланцев на трубопроводе с отверстиями во фланцах задвижки."
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: снять заглушки; расконсервировать... Объяснение: Перед монтажом необходимо: снять заглушки, расконсервировать, заменить набивку, очистить проходы, закрепить трубопровод, совместить отверстия фланцев."
            },
            {
                question: "Какие работы относятся к работам в замкнутом пространстве",
                options: [
                    "Это работы повышенной опасности , работы при недостаточном содержание кислорода (менее 20%) ,которой невозможно без участия человека.",
                    "Это работы повышенной опасности , работы при недостаточном содержание кислорода (более 20%) ,которой невозможно без участия человека",
                    "Это работы повышенной опасности , работы при недостаточном содержание кислорода (менее 25%) ,которой невозможно без участия человека"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Это работы повышенной опасности... Объяснение: Работы в замкнутом пространстве характеризуются повышенной опасностью и недостаточным содержанием кислорода (менее 20%)."
            },
            {
                question: "При каких условиях запрещено проведение работа на высоте?",
                options: [
                    "При скорости ветра для всех работ более 15 м/с; 12.5 м/с и более для работ по замеру уровней и отбору проб нефтепродуктов в резервуарах ручным способом ; 10 м/с и более для монтажа-демонтажа конструкции",
                    "При обледенение",
                    "При грозе",
                    "Все вышеперечисленное.",
                    "При дожде"
                ],
                correct: 3,
                category: "Безопасность",
                explanation: "Правильный ответ: Все вышеперечисленное. Объяснение: Работы на высоте запрещены при сильном ветре, обледенении, грозе и дожде. Эти условия создают повышенный риск для работников."
            },
            {
                question: "Какое количество исполнителей должно быть при производстве земляных работ?",
                options: [
                    "Не менее 2-х человек.",
                    "Не менее 3-х человек",
                    "Не менее 4-х человек"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Не менее 2-х человек. Объяснение: При производстве земляных работ должно быть не менее двух исполнителей для взаимного контроля и оказания помощи в случае необходимости."
            },
            {
                question: "На каком расстояние друг от друга должны двигаться транспортные средства при работах на льду и движение по ледовым переправам?",
                options: [
                    "Все транспортные средства двигаются в один ряд , расстояние между ними не менее 40 метров",
                    "Все транспортные средства двигаются в один ряд , расстояние между ними не менее 30 метров.",
                    "Все транспортные средства двигаются в один ряд , расстояние между ними не более 30 метров"
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: Все транспортные средства двигаются... Объяснение: При движении по ледовым переправам транспортные средства должны двигаться в один ряд с расстоянием не менее 30 метров между ними."
            },
            {
                question: "Какие работы относятся к огневым работам?",
                options: [
                    "Работы с применением открытого огня, искрообразованием и нагреванием до температуры воспламенения материалов и конструкций (электросварка, газосварка, бензино- и керосинорезательные работы, паяльные работы, механическая обработка металла с образованием искр и т. п.)."
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Работы с применением открытого огня... Объяснение: Огневые работы включают любые операции с использованием открытого огня, искр или нагрева до температур воспламенения материалов."
            },
            {
                question: "Что должен оценить и знать работник перед проведением работ согласно золотых правил безопасности труда",
                options: [
                    "оценить существующие опасности и предпринять меры по исключению/снижению их воздействия, знать золотые правила безопасности труда.",
                    "Знать как правильно выполнить работу"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: оценить существующие опасности... Объяснение: Согласно золотым правилам безопасности, работник должен оценить риски и принять меры для их снижения, а также знать правила безопасности."
            },
            {
                question: "С какой периодичностью оператор ПСКиПР должен проходить проверку знаний по основной профессии,инструктаж ,проверку знаний по электробезопасности?",
                options: [
                    "Работник должен проходить не реже 1 раза в три месяца проверку знаний по основной профессии; инструктаж, проверку знаний по электробезопасности",
                    "Работник должен проходить не реже 1 раза в пол года проверку знаний по основной профессии; инструктаж, проверку знаний по электробезопасности",
                    "Работник должен проходить не реже 1 раза в год проверку знаний по основной профессии; инструктаж, проверку знаний по электробезопасности."
                ],
                correct: 2,
                category: "Безопасность",
                explanation: "Правильный ответ: Работник должен проходить не реже 1 раза в год... Объяснение: Периодичность проверки знаний для оператора ПСКиПР - не реже одного раза в год по основной профессии и электробезопасности."
            },
            {
                question: "В каком документе отражены нормы бесплатной выдачи специальной одежды, специальной обуви и других средств индивидуальной защиты?",
                options: [
                    "В коллективном договоре.",
                    "В технологической инструкции",
                    "В локально-нормативной документации"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: В коллективном договоре. Объяснение: Нормы выдачи СИЗ отражаются в коллективном договоре организации, который является основным документом в этой сфере."
            },
            {
                question: "Перечислите виды инструктажей?",
                options: [
                    "Вводный инструктаж, Инструктаж на рабочем месте, целевой инструктаж.",
                    "Вводный инструктаж, Целевой инструктаж, Внеплановый инструктаж",
                    "Вводный инструктаж, Первичный инструктаж, Повторный инструктаж, Внеплановый инструктаж, Целевой инструктаж"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Вводный инструктаж, Инструктаж на рабочем месте... Объяснение: Основные виды инструктажей: вводный (при приеме на работу), на рабочем месте (первичный, повторный, внеплановый), целевой (перед конкретными работами)."
            },
            {
                question: "Какие лица допускаются к самостоятельной работе в качестве оператора ПСКиПР?",
                options: [
                    "не моложе 18 лет, умеет правильно выполнить работу, прошедшие обучение первой медицинской помощи",
                    "не моложе 18 лет, прошедшее предварительный и периодические медицинские осмотры, прошедшее обучение в области промышленной безопасности, охраны труда, безопасным методам и приемам выполнения работ."
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: не моложе 18 лет, прошедшее предварительный... Объяснение: Требования к оператору ПСКиПР: возраст не менее 18 лет, медосмотры, обучение по промышленной безопасности и охране труда."
            },
            {
                question: "Возникновение каких опасных и вредных производственных факторов возможно при отборе проб воздушной среды и при работе с газоанализатором?",
                options: [
                    "Связанные с черезмерно высокой или низкой температурой материальных объектов производственной среды,",
                    "отсутствие или недостаток необходимого искусственного освещения",
                    "Связанные с черезмерным загрязнением воздушной среды в зоне дыхания",
                    "отсутствие или недостаток необходимого естественного освещения",
                    "Все вышеперечисленное.",
                    "Ответ 1,3",
                    "Ответ 2,4"
                ],
                correct: 4,
                category: "Безопасность",
                explanation: "Правильный ответ: Все вышеперечисленное. Объяснение: При отборе проб возможны все перечисленные факторы: экстремальные температуры, недостаточное освещение, загрязнение воздуха."
            },
            {
                question: "В каких случаях оператор ПСКиПР должен пройти в обязательном порядке внеплановый и целевой инструктаж для допуска к проведению работ?",
                options: [
                    "при изменениях в эксплуатации оборудования, при изменениях нормативных правовых актов, по требованию должностных лиц органов государственного контроля и надзора, при произошедших авариях и несчастных случаях, при перерывах в работе продолжительностью более 60 календарных дней, по решению работодателя.",
                    "перед проведением работ, выполнение которых допускается только под непрерывным контролем работодателя, работ повышенной опасности, перед выполнением работ на объектах повышенной опасности, погрузочно-разгрузочных работ, работ по уборке территорий, перед выполнением работ по ликвидации последствий чрезвычайных ситуаций, в иных случаях, установленных работодателем.",
                    "Все вышеперечисленное."
                ],
                correct: 2,
                category: "Безопасность",
                explanation: "Правильный ответ: Все вышеперечисленное. Объяснение: Внеплановый инструктаж требуется при изменениях в работе, авариях, длительных перерывах. Целевой - перед работами повышенной опасности."
            },
            {
                question: "На каком расстояние от дренажной емкости устанавливаются автомашина для откачки водонефтяной эмульсии?",
                options: [
                    "Установить спецагрегат на расстоянии 10 метров от дренажной емкости, убедиться в отсутствии пропусков газа на оборудовании и трубопроводах дренажной емкости.",
                    "Установить спецагрегат на расстоянии менее 10 метров от дренажной емкости, убедиться в отсутствии пропусков газа на оборудовании и трубопроводах дренажной емкости",
                    "Установить спецагрегат на расстоянии 5 метров от дренажной емкости, убедиться в отсутствии пропусков газа на оборудовании и трубопроводах дренажной емкости"
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: Установить спецагрегат на расстоянии 10 метров... Объяснение: Безопасное расстояние для спецагрегата при откачке водонефтяной эмульсии - не менее 10 метров от дренажной емкости."
            },
            {
                question: "Что необходимо проверить при обслуживание запорной арматуры?",
                options: [
                    "состояние сварных швов запорной арматуры; плавность перемещения всех подвижных частей запорной арматуры; правильность сборки всех фланцевых присоединений, обращая внимание на равномерность затяжки шпилек и параллельность привалочных поверхностей"
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: состояние сварных швов запорной арматуры... Объяснение: При обслуживании запорной арматуры проверяют состояние сварных швов, плавность хода подвижных частей, правильность сборки фланцевых соединений."
            },
            {
                question: "Какие меры безопасности необходимо соблюдать перед входом в загазованную зону?",
                options: [
                    "исправность противогаза, тщательно осмотреть шланг, проверить прочность и надежность соединений всех частей противогаза по инструкции, прилагаемой к каждому комплекту ПШ; маска-шлем противогаза должна быть подобрана по размеру и плотно прилегать к лицу, не вызывая болевых ощущений."
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: исправность противогаза, тщательно осмотреть шланг... Объяснение: Перед входом в загазованную зону необходимо проверить исправность противогаза, состояние шланга и соединений, правильность подгонки маски."
            },
            {
                question: "Какие противогазы используются при проведении газоопаных работ?",
                options: [
                    "Фильтрующий противогай",
                    "Изолирующий противогаз",
                    "Шланговый противогаз."
                ],
                correct: 2,
                category: "Безопасность",
                explanation: "Правильный ответ: Шланговый противогаз. Объяснение: При газоопасных работах используются шланговые противогазы, которые обеспечивают подачу чистого воздуха из незагазованной зоны."
            },
            {
                question: "Какой период времени не должен превышать срок единовременного пребывания , работающего в шланговом противогазе?",
                options: [
                    "Срок единовременного пребывания работающего в шланговом противогазе не должен превышать 30 минут с последующим отдыхом не менее 15 минут.",
                    "Срок единовременного пребывания работающего в шланговом противогазе не должен превышать 20 минут с последующим отдыхом не менее 15 минут",
                    "Срок единовременного пребывания работающего в шланговом противогазе не должен превышать 60 минут с последующим отдыхом не менее 15 минут"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Срок единовременного пребывания... Объяснение: Максимальное время непрерывной работы в шланговом противогазе - 30 минут с обязательным отдыхом не менее 15 минут."
            },
            {
                question: "Когда проводится проверка исправности пояса и веревки работником?",
                options: [
                    "Исправность пояса и веревки должна проверяться работником каждый раз перед его применением, а ответственным лицом не реже 2 раза в декаду производить визуальный осмотр пояса и проверять его исправность: на поясе не должно быть повреждений; наконечник ремня должен свободно входить в прорезь язычка пряжки, а в случае разлохмачивания материала его нужно оплавить на огне спички и затереть; пружины карабина должны быть осмотрены, смазаны маслом и плотно прижата предохранительная чека к зеву крюка.",
                    "Исправность пояса и веревки должна проверяться работником каждый раз перед его применением, а ответственным лицом не реже 1 раза в декаду производить визуальный осмотр пояса и проверять его исправность"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Исправность пояса и веревки должна проверяться... Объяснение: Работник проверяет пояс перед каждым использованием, ответственное лицо - не реже 2 раз в декаду. Проверяют отсутствие повреждений, состояние пряжки и карабина."
            },
            {
                question: "Какова периодичность осмотра съемных грузозахватных приспособлений и тары?",
                options: [
                    "2 раза в месяц, за исключением редко используемых; клещи, траверсы, другие захваты, тара - каждый месяц; редко используемые съемные грузозахватные приспособления - перед выдачей их в работу",
                    "1 раз в месяц, за исключением редко используемых; клещи, траверсы, другие захваты, тара - каждый месяц; редко используемые съемные грузозахватные приспособления - перед выдачей их в работу",
                    "1 раз в 10 дней, за исключением редко используемых; клещи, траверсы, другие захваты, тара - каждый месяц; редко используемые съемные грузозахватные приспособления - перед выдачей их в работу."
                ],
                correct: 2,
                category: "Безопасность",
                explanation: "Правильный ответ: 1 раз в 10 дней, за исключением редко используемых... Объяснение: Стропы осматривают каждые 10 дней, клещи и траверсы - ежемесячно, редко используемые приспособления - перед каждой выдачей."
            },
            {
                question: "Какие съемные грузозахватные приспособления не допускаются к эксплуатации?",
                options: [
                    "крюки не имеют предохранительных замков; имеются узлы, порезы, обрывы нитей стропов из синтетических лент на текстильной основе, повреждения лент от воздействия химических веществ; имеются повреждения на канатных и цепных съемных грузозахватных приспособлениях",
                    "отсутствует бирка (клеймо); деформированы коуши; имеются трещины на опрессовочных втулках; имеются смещения каната в заплетке или втулках, крюки не имеют предохранительных замков; имеются узлы, порезы, обрывы нитей стропов из синтетических лент на текстильной основе, повреждения лент от воздействия химических веществ; имеются повреждения на канатных и цепных съемных грузозахватных приспособлениях.",
                    "Нет правильного ответа"
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: отсутствует бирка (клеймо); деформированы коуши... Объяснение: К эксплуатации не допускаются приспособления без маркировки, с дефектами коушей, трещинами на втулках, повреждениями стропов, отсутствием замков на крюках."
            },
            {
                question: "При какой высоте груза работник может находится возле него при проведение погрузочно-разгрузочных работ?",
                options: [
                    "Работник может находиться возле груза во время его подъема или опускания, если груз поднят на высоту не более 1000 мм от уровня площадки, на которой стоит работник.",
                    "Работник может находиться возле груза во время его подъема или опускания, если груз поднят на высоту не более 1500 мм от уровня площадки, на которой стоит работник",
                    "Работник может находиться возле груза во время его подъема или опускания, если груз поднят на высоту не более 2000 мм от уровня площадки, на которой стоит работник"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Работник может находиться возле груза... Объяснение: Безопасное расстояние - работник может находиться у груза только если он поднят не выше 1000 мм от уровня площадки."
            },
            {
                question: "На какую высоту должны быть подняты груз или грузозахватное приспособление при их горизонтальном перемещении?",
                options: [
                    "Груз или грузозахватное приспособление при их горизонтальном перемещении должны быть предварительно подняты на 1000 мм выше встречающихся на пути предметов",
                    "Груз или грузозахватное приспособление при их горизонтальном перемещении должны быть предварительно подняты на 500 мм выше встречающихся на пути предметов.",
                    "Груз или грузозахватное приспособление при их горизонтальном перемещении должны быть предварительно подняты на 1500 мм выше встречающихся на пути предметов"
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: Груз или грузозахватное приспособление... Объяснение: При горизонтальном перемещении груз должен быть поднят на 500 мм выше встречающихся препятствий для обеспечения безопасности."
            },
            {
                question: "Разрешается ли подтаскивание грузов краном-манипулятором при наклоне положение грузовых канатов",
                options: [
                    "Не разрешается.",
                    "Разрешается",
                    "Разрешается еси это безопасно"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Не разрешается. Объяснение: Подтаскивание грузов краном-манипулятором при наклонном положении канатов запрещено, так как это создает риск обрыва канатов и падения груза."
            },
            {
                question: "Разрешается еси это безопасно",
                options: [
                    "Для строповки предназначенного к подъему груза должны применяться стропы, соответствующие массе и характеру поднимаемого груза с учетом числа ветвей и их угла наклона. Стропы общего назначения следует подбирать так, чтобы угол между их ветвями не превышал 90."
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: Для строповки предназначенного к подъему груза... Объяснение: При строповке необходимо подбирать стропы по массе груза, учитывать угол между ветвями (не более 90 градусов) для обеспечения безопасности."
            },
            {
                question: "Какие СИЗ применяются при работе с хим.реагентами?",
                options: [
                    "резиновые перчатки, фартук из ПВХ, противогаз",
                    "очки защитные, перчатки, фартук из ПВХ",
                    "очки защитные, резиновые перчатки, фартук из ПВХ, респиратор."
                ],
                correct: 2,
                category: "Химия",
                explanation: "Правильный ответ: очки защитные, резиновые перчатки... Объяснение: Полный комплект СИЗ при работе с химреагентами включает: защитные очки, резиновые перчатки, фартук из ПВХ и респиратор."
            },
            {
                question: "Какие предупредительные и запрещающие знаки должны быть вывешены на БРХ?",
                options: [
                    "Огнеопасно», «Запрещается пользоваться открытым огнем», «Запрещается курить», «Осторожно! Легковоспламеняющаяся жидкость», «Осторожно! Ядовитое вещество!»",
                    "Огнеопасно», «Запрещается пользоваться открытым огнем», «Запрещается курить», «Осторожно! Легковоспламеняющаяся жидкость», «Осторожно! Ядовитое вещество!», а также табличка с указанием класса и категории взрывопожароопасности и указанием лица, ответственного за пожарную безопасность объекта."
                ],
                correct: 1,
                category: "Безопасность",
                explanation: "Правильный ответ: Огнеопасно», «Запрещается пользоваться открытым огнем»... Объяснение: На БРХ должны быть вывешены все перечисленные знаки плюс табличка с классом взрывопожароопасности и указанием ответственного за пожарную безопасность."
            },
            {
                question: "Из какого материала должны быть выполнены пробоотборники?",
                options: [
                    "Для крепления переносного пробоотборника используют гибкие, не дающие искр металлические тросики."
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: Для крепления переносного пробоотборника... Объяснение: Пробоотборники должны крепиться гибкими металлическими тросиками, не дающими искр, для обеспечения безопасности во взрывоопасных средах."
            },
            {
                question: "Что запрещается при отборе проб?",
                options: [
                    "запрещается отбор проб нефти или нефтепродукта из резервуара менее чем через 2 часа после окончания заполнения резервуара; запрещается проводить отбор проб химических реагентов без применения защитных очков; переносить стеклянную посуду с пробами в сумках-авоськах и полиэтиленовых пакетах; использовать стеклянную посуду при отборе проб горячих жидкостей; проводить отбор проб химических реагентов в темное время суток; производить отбор проб во время грозы и скорости ветра выше 12,5 м/с и более.",
                    "запрещается отбор проб нефти или нефтепродукта из резервуара менее чем через 3 часа после окончания заполнения резервуара; запрещается проводить отбор проб химических реагентов без применения защитных очков; переносить стеклянную посуду с пробами в сумках-авоськах и полиэтиленовых пакетах; использовать стеклянную посуду при отборе проб горячих жидкостей; проводить отбор проб химических реагентов в темное время суток; производить отбор проб во время грозы и скорости ветра выше 10 м/с и более"
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: запрещается отбор проб нефти или нефтепродукта... Объяснение: Запрещено отбирать пробы в течение 2 часов после заполнения резервуара, без защитных очков, в ненадежной таре, при неблагоприятных погодных условиях."
            },
            {
                question: "Каким способом осуществляется доставка и перевозка проб химических реагентов?",
                options: [
                    "Доставка и перевозка проб химических реагентов и нефтепродуктов должна осуществляться в грузовых отсеках спецтранспорта, в ящиках. При перевозке должны быть приняты меры по исключению их самопроизвольного перемещения в кузове автомобиля.",
                    "Доставка и перевозка проб химических реагентов и нефтепродуктов должна осуществляться в грузовых отсеках спецтранспорта. При перевозке должны быть приняты меры по исключению их самопроизвольного перемещения в кузове автомобиля"
                ],
                correct: 0,
                category: "Химия",
                explanation: "Правильный ответ: Доставка и перевозка проб химических реагентов... Объяснение: Пробы должны перевозиться в спецтранспорте в ящиках с мерами по предотвращению перемещения для обеспечения безопасности."
            },
            {
                question: "Какие требования необходимо соблюдать при отборе проб химических реагентов и нефтепродуктов с емкостей (резервуаров)?",
                options: [
                    "Отбор проб химических реагентов и нефтепродуктов из резервуаров, цистерн, емкостей и из трубопроводов необходимо производить стоя с наветренной стороны (спиной к ветру), во избежание вдыхания паров нефти и газа."
                ],
                correct: 0,
                category: "Химия",
                explanation: "Правильный ответ: Отбор проб химических реагентов и нефтепродуктов... Объяснение: При отборе проб необходимо стоять с наветренной стороны, чтобы избежать вдыхания опасных паров и газов."
            },
            {
                question: "Какие требования необходимо соблюдать при расстановке спецтехники на месте производства по сбору из скважин и регенерации растворов на основе кальциевых солей (CaCl2, триасалт ст, ниткал, нитрат кальция)?",
                options: [
                    "агрегаты устанавливаются кабинами от устья скважины; передвижные насосные установки и автоцистерны - не менее 15 м от устья скважины; передвижные компрессоры, передвижная поровая установка (ППУ), агрегат депарафинизации передвижной, модернизированный (АДПМ), и т.д. - не менее 25 м от устья скважины и 15 м от другого оборудования",
                    "агрегаты устанавливаются кабинами от устья скважины; передвижные насосные установки и автоцистерны - не менее 10 м от устья скважины; передвижные компрессоры, передвижная поровая установка (ППУ), агрегат депарафинизации передвижной, модернизированный (АДПМ), и т.д. - не менее 25 м от устья скважины и 10 м от другого оборудования."
                ],
                correct: 1,
                category: "Оборудование",
                explanation: "Правильный ответ: агрегаты устанавливаются кабинами от устья скважины... Объяснение: Требования к расстановке техники: агрегаты - кабинами от устья, насосные установки и автоцистерны - не менее 10 м, компрессоры и ППУ - не менее 25 м от устья и 10 м от другого оборудования."
            },
            {
                question: "Какие требования предъявляються к поступающим хим. реагентом , материалом для приготовления жидкостей глушения скважин?",
                options: [
                    "Поступающие химические реагенты и материалы для приготовления жидкостей глушения скважин должны быть в исправной упаковке, таре, иметь ярлыки, бирки или наклейки с точным наименованием, трафареты, маркировку, сопроводительные документы, паспорт безопасности. Места хранения должны иметь знаки опасности."
                ],
                correct: 0,
                category: "Химия",
                explanation: "Правильный ответ: Поступающие химические реагенты и материалы... Объяснение: Химреагенты должны поступать в исправной таре с полной маркировкой, сопроводительными документами и паспортом безопасности. Места хранения должны иметь знаки опасности."
            },
            {
                question: "Какие химические реагенты, соли применяются на соле-растворных узлах канадского производства в процессах приготовления технологической жидкости глушения?",
                options: [
                    "Хлористый натрий (NaCL), Калий хлористый (KCL), Хлористый кальций (СаСL2), Нитрат кальция, Соль.",
                    "Гидрофобизатор ГФ-1, Сонкор 9027, Загуститель-структурообразователь BIOPOL, Ипроден С-2"
                ],
                correct: 0,
                category: "Химия",
                explanation: "Правильный ответ: Хлористый натрий (NaCL), Калий хлористый (KCL)... Объяснение: На солевых узлах применяются хлористые соли натрия, калия, кальция, нитрат кальция и поваренная соль для приготовления технологических жидкостей."
            },
            {
                question: "Что обязан работник перед запуском транспортной ленты?",
                options: [
                    "Перед запуском транспортерной ленты работник производит её визуальный осмотр на предмет наличия дефектов (механических повреждений, разрыв, прилегания транспортерной ленты к роликам и барабану, отсутствия провисания). При обнаружении неисправности немедленно сообщить непосредственному руководителю.",
                    "Перед запуском транспортерной ленты работник производит её визуальный осмотр на предмет наличия дефектов (механических повреждений, разрыв, прилегания транспортерной ленты к роликам и барабану, отсутствия провисания"
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: Перед запуском транспортерной ленты работник производит... Объяснение: Перед запуском ленты необходимо провести визуальный осмотр на наличие повреждений, правильность прилегания к роликам и отсутствие провисания. При обнаружении дефектов - сообщить руководителю."
            },
            {
                question: "Что обязан работник при обслуживании оборудования(задвижек,насосов)?",
                options: [
                    "Перед началом работ по разборке или техническому обслуживанию оборудования (задвижек, насосов) необходимо: отключить электропитание оборудования и принять меры по исключению его подачи на время производства работ; если оборудование нагрето, дать время на то, чтобы оно остыло",
                    "Перед началом выполнения ремонтных работ или технического обслуживания, работник должен перекрыть трубопроводы линий перекачки и линий подачи воды, после чего стравить давление на нагнетательной линии. Перед началом работ по разборке или техническому обслуживанию оборудования (задвижек, насосов) необходимо: отключить электропитание оборудования и принять меры по исключению его подачи на время производства работ; если оборудование нагрето, дать время на то, чтобы оно остыло."
                ],
                correct: 1,
                category: "Оборудование",
                explanation: "Правильный ответ: Перед началом выполнения ремонтных работ... Объяснение: При обслуживании оборудования необходимо: перекрыть трубопроводы, стравить давление, отключить электропитание, дать оборудованию остыть."
            },
            {
                question: "Какие документы предъявляются к АЦ для налива технологической жидкости ИНЭР и БСГ?",
                options: [
                    "при наличии паспорта тарировки цистерны, акта пропарки, талона на отпуск, плана работ на ИНЭР и БСГ."
                ],
                correct: 0,
                category: "Безопасность",
                explanation: "Правильный ответ: при наличии паспорта тарировки цистерны... Объяснение: Для налива технологической жидкости необходимы: паспорт тарировки цистерны, акт пропарки, талон на отпуск и план работ."
            },
            {
                question: "Какие требования предусматривается к емкостям на эстакаде?",
                options: [
                    "Емкости на эстакаде должны быть оборудованы: запорной арматурой для слива раствора; замерным устройством для контроля за расходом и наличием жидкости."
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: Емкости на эстакаде должны быть оборудованы... Объяснение: Емкости на эстакаде должны иметь запорную арматуру для слива и замерное устройство для контроля уровня и расхода жидкости."
            },
            {
                question: "Что обязан сделать работник перед пуском насоса миксера приготовления раствора?",
                options: [
                    "Перед пуском насоса необходимо сделать следующее: удалить с насоса все посторонние предметы; проверить, нет ли поврежденных частей насоса; проверить исправность манометра на трубопроводе нагнетания насоса; убедиться в наличии заземления насоса и электродвигателя; убедиться в исправном состоянии трубопроводов; убедиться в исправном состоянии предохранительных и ограждающих устройств; проверить правильность направления вращения кратковременным пуском насоса."
                ],
                correct: 0,
                category: "Оборудование",
                explanation: "Правильный ответ: Перед пуском насоса необходимо сделать следующее... Объяснение: Перед пуском насоса необходимо проверить отсутствие посторонних предметов, исправность частей и манометра, наличие заземления, состояние трубопроводов и ограждений, направление вращения."
            },
            {
                question: "Для чего предназначены ингибитор солеотложения?",
                options: [
                    "Ингибиторы солеотложения - предназначены для предотвращения отложений труднорастворимых солей кальция, магния, бария, стронция и железа."
                ],
                correct: 0,
                category: "Химия",
                explanation: "Правильный ответ: Ингибиторы солеотложения - предназначены... Объяснение: Ингибиторы солеотложения предотвращают образование отложений солей кальция, магния, бария, стронция и железа в оборудовании."
            },
            {
                question: "Для чего предназначен ингибитор коррозии?",
                options: [
                    "Ингибиторы коррозии предназначены для защиты от коррозии напорных и выкидных трубопроводов, транспортирующих обводненные газожидкостные и нефтяные среды, содержащие сероводород и углекислый газ."
                ],
                correct: 0,
                category: "Химия",
                explanation: "Правильный ответ: Ингибиторы коррозии предназначены... Объяснение: Ингибиторы коррозии защищают трубопроводы от коррозионного воздействия обводненных сред, содержащих сероводород и углекислый газ."
            },
            {
                question: "Какие основные неисправности ручного бочкового насоса и их причины?",
                options: [
                    "насос не залит перекачиваемой жидкостью; во всасывающую полость насоса проникает воздух. Пульсирующая подача перекачиваемой жидкости",
                    "большая высота всасывания; на всасывающей линии имеются не плотности. Наблюдается течь жидкости через сальниковое уплотнение",
                    "резиновые кольца имеют износ выше допустимого. Нагрев сальникового уплотнения",
                    "засорены перепускные каналы от внутренней полости сальникового уплотнения к разгрузочному клапану",
                    "Всё вышеперечисленное.",
                    "Ответ 1,2,3"
                ],
                correct: 4,
                category: "Оборудование",
                explanation: "Правильный ответ: Всё вышеперечисленное. Объяснение: Основные неисправности ручного насоса: отсутствие жидкости во всасывающей полости, попадание воздуха, большая высота всасывания, неплотности в линии, износ сальниковых колец, засорение каналов."
            }
        ];
        
        // Вопросы по Золотым правилам безопасности труда
        let goldRulesQuestions = [
            {
                question: "Кем должны использоваться ремни безопасности при перевозке людей автотранспортом?",
                options: [
                    "Водителем и всеми пассажирами.",
                    "Водителем",
                    "Водителем и старшим по автобусу"
                ],
                correct: 0,
                explanation: "Правильный ответ: Водителем и всеми пассажирами. Объяснение: Ремни безопасности должны использоваться всеми находящимися в транспортном средстве для обеспечения безопасности."
            },
            {
                question: "Где необходимо обеспечить контроль за состояния воздушной среды при производстве газоопасных работ?",
                options: [
                    "На рабочем месте",
                    "При работах в котловане",
                    "При работах в замкнутом пространстве",
                    "Правильные ответы 3 и 4",
                    "На рабочем месте и в опасной зоне."
                ],
                correct: 4,
                explanation: "Правильный ответ: На рабочем месте и в опасной зоне. Объяснение: Контроль воздушной среды необходим как на самом рабочем месте, так и в прилегающей опасной зоне."
            },
            {
                question: "Разрешается ли перемещать груз при нахождении под ним людей?",
                options: [
                    "Запрещается.",
                    "Разрешается при наличии защитной каски",
                    "Разрешается",
                    "Разрешается если это прописано в наряде-допуске"
                ],
                correct: 0,
                explanation: "Правильный ответ: Запрещается. Объяснение: Перемещение груза над людьми категорически запрещено из-за риска падения груза."
            },
            {
                question: "Запрещены ли работы на высоте при грозе?",
                options: [
                    "Разрешены",
                    "Запрещены.",
                    "Разрешены по согласовании с руководителем объекта"
                ],
                correct: 1,
                explanation: "Правильный ответ: Запрещены. Объяснение: Работы на высоте во время грозы запрещены из-за высокой опасности поражения молнией."
            },
            {
                question: "При какой скорости ветра запрещены работы на высоте при монтаже-демонтаже конструкций?",
                options: [
                    "15 м/с и более",
                    "10 м/с и более.",
                    "12 м/с и более"
                ],
                correct: 1,
                explanation: "Правильный ответ: 10 м/с и более. Объяснение: При монтаже-демонтаже конструкций работы на высоте запрещены при скорости ветра 10 м/с и более."
            },
            {
                question: "Как должна доводиться памятка «Золотые правила по безопасности труда» до работников подрядных/субподрядных организаций:",
                options: [
                    "В ходе проведения вводного инструктажа",
                    "Размещения текста Памятки «Золотые правила безопасности труда» на информационных стендах для ознакомления",
                    "Любым из перечисленных способов.",
                    "Обеспечения работников информационными буклетами предпочтительно «карманного» формата, для удобства ношения и использования на рабочих местах",
                    "Демонстрации презентационных материалов",
                    "Производства и демонстрации видео и анимационных роликов",
                    "Размещения памятки на информационном ресурсе"
                ],
                correct: 2,
                explanation: "Правильный ответ: Любым из перечисленных способов. Объяснение: Памятка может доводиться до работников любым удобным способом из перечисленных."
            },
            {
                question: "Должна ли быть на оборудовании, находящимся под воздействием энергии любого рода, соответствующая блокировка с предупредительными табличками в точках отключения?",
                options: [
                    "Должна.",
                    "Не должна",
                    "Не обязательно"
                ],
                correct: 0,
                explanation: "Правильный ответ: Должна. Объяснение: Оборудование под воздействием энергии должно иметь блокировку с предупредительными табличками в точках отключения."
            },
            {
                question: "Разрешается ли эксплуатация оборудования при отсутствии или неисправности защитных устройств и приспособлений?",
                options: [
                    "Запрещается.",
                    "Разрешается",
                    "Разрешается по согласованию со службой ПБОТОС"
                ],
                correct: 0,
                explanation: "Правильный ответ: Запрещается. Объяснение: Эксплуатация оборудования без защитных устройств или при их неисправности запрещена."
            },
            {
                question: "Какие должны соблюдаться условия при проведении грузоподъемных операций с применением кранов, лебедок, механических подъемных устройств, грузозахватных приспособлений?",
                options: [
                    "Грузоподъемное оборудование и механизмы визуально исправны, должны иметь лицензию и допущены к эксплуатации",
                    "Грузоподъемное оборудование и механизмы визуально и технически не исправны, должны иметь лицензию и допущены к эксплуатации",
                    "Грузоподъемное оборудование и механизмы технически исправны, освидетельствованы и допущены к эксплуатации."
                ],
                correct: 2,
                explanation: "Правильный ответ: Грузоподъемное оборудование и механизмы технически исправны, освидетельствованы и допущены к эксплуатации. Объяснение: Грузоподъемное оборудование должно быть технически исправным и прошедшим освидетельствование."
            },
            {
                question: "Чем должны быть огорожены и защищены движущие (вращающиеся) части механизмов?",
                options: [
                    "Ограждениями, кожухами и защитными экранами.",
                    "Сигнальной лентой",
                    "Забором",
                    "Сигнальной лентой и забором",
                    "Правильные ответы 3 и 4"
                ],
                correct: 0,
                explanation: "Правильный ответ: Ограждениями, кожухами и защитными экранами. Объяснение: Движущиеся части механизмов должны быть защищены специальными ограждениями."
            },
            {
                question: "Что называется газоопасными работами?",
                options: [
                    "Это работы, при которых имеется возможность выделения в воздух рабочей зоны взрывопожароопасных или вредных паров, газов и других веществ, а также работы при недостаточном содержании кислорода, в том числе проводимые внутри аппаратов, емкостей, колодцев, тоннелей, траншей, приямков и других аналогичных местах.",
                    "Это работы, при которых отсутствует возможность выделения в воздух рабочей зоны взрывопожароопасных или вредных паров, газов и других веществ, а также работы при недостаточном содержании кислорода, в том числе проводимые внутри аппаратов, емкостей, колодцев, тоннелей, траншей, приямков и других аналогичных местах"
                ],
                correct: 0,
                explanation: "Правильный ответ: Это работы, при которых имеется возможность выделения в воздух рабочей зоны взрывопожароопасных или вредных паров, газов и других веществ... Объяснение: Газоопасные работы характеризуются риском выделения опасных веществ и недостатком кислорода."
            },
            {
                question: "Разрешается ли стоять под стрелой грузоподъёмного механизма при ее подъеме и опускании?",
                options: [
                    "Разрешается",
                    "Запрещается.",
                    "Разрешается если поднимаемый груз не превышает 50 кг",
                    "Правильные ответы 1 и 3"
                ],
                correct: 1,
                explanation: "Правильный ответ: Запрещается. Объяснение: Находиться под стрелой грузоподъемного механизма запрещено из-за риска падения груза или стрелы."
            },
            {
                question: "Что называется огневыми работами?",
                options: [
                    "Работы с применением открытого огня, искрообразованием и нагреванием до температуры воспламенения материалов и конструкций (электросварка, газосварка, бензино- и керосинорезательные работы, паяльные работы, механическая обработка металла с образованием искр и т. п.).",
                    "Работы с применением закрытого огня, искрообразованием и нагреванием до температуры нагрева материалов и конструкций (электросварка, газосварка, бензино- и керосинорезательные работы, паяльные работы, механическая обработка металла с образованием искр и т. п.)",
                    "Работы с применением огня, искрообразованием и нагреванием до температуры вспышки материалов и конструкций (электросварка, газосварка, бензино- и керосинорезательные работы, паяльные работы, механическая обработка металла с образованием искр и т. п.)"
                ],
                correct: 0,
                explanation: "Правильный ответ: Работы с применением открытого огня, искрообразованием и нагреванием до температуры воспламенения материалов и конструкций... Объяснение: Огневые работы включают операции с открытым огнем, искрами или нагревом до температур воспламенения."
            },
            {
                question: "Что необходимо неукоснительно выполнять при производстве работ повышенной опасности?",
                options: [
                    "Требования трудового кодекса",
                    "Требования ООО «РН-Юганскнефтегаза»",
                    "Поручение мастера",
                    "Требования законодательства РФ, нормативных правовых документов РФ и локальных нормативных документов в области безопасности труда."
                ],
                correct: 3,
                explanation: "Правильный ответ: Требования законодательства РФ, нормативных правовых документов РФ и локальных нормативных документов в области безопасности труда. Объяснение: При работах повышенной опасности необходимо строго соблюдать все требования законодательства и нормативных документов по безопасности."
            },
            {
                question: "Разрешается ли перемещать людей грузоподъёмными механизмами, не предназначенными для данных целей?",
                options: [
                    "Разрешается",
                    "Разрешается при условии наличия страховочного троса",
                    "Запрещается.",
                    "Разрешается если это прописано в наряде-допуске"
                ],
                correct: 2,
                explanation: "Правильный ответ: Запрещается. Объяснение: Перемещение людей грузоподъемными механизмами, не предназначенными для этих целей, запрещено."
            },
            {
                question: "Что необходимо оформить перед началом работ повышенной опасности?",
                options: [
                    "Акт",
                    "Лицензию на объекты ООО «РН-Юганскнефтегаз»",
                    "Наряд-допуск.",
                    "Наряд-допуск и лицензию на объекты ООО «РН-Юганскнефтегаз»"
                ],
                correct: 2,
                explanation: "Правильный ответ: Наряд-допуск. Объяснение: Перед началом работ повышенной опасности необходимо оформить наряд-допуск."
            },
            {
                question: "«Золотые правила по безопасности труда» - это?",
                options: [
                    "Сборник инструкций ООО «РН-Юганскнефтегаза»",
                    "Памятка",
                    "Ключевые требования безопасного выполнения работ в виде отдельного документа (памятки)",
                    "Регламент ООО «РН-Юганскнефтегаза».",
                    "Свод правил в виде памятки"
                ],
                correct: 3,
                explanation: "Правильный ответ: Регламент ООО «РН-Юганскнефтегаза». Объяснение: «Золотые правила по безопасности труда» являются регламентом организации."
            },
            {
                question: "В каком случае запрещается снятие (отключение) блокировок у источников энергии?",
                options: [
                    "До полного завершения всех работ на оборудовании.",
                    "До истечения времени действия наряда-допуска",
                    "До письменного распоряжения главного инженера подрядной организации"
                ],
                correct: 0,
                explanation: "Правильный ответ: До полного завершения всех работ на оборудовании. Объяснение: Блокировки можно снимать только после полного завершения всех работ на оборудовании."
            },
            {
                question: "Должен ли быть обеспечен контроль состояния воздушной среды при работах в замкнутом пространстве?",
                options: [
                    "Должен.",
                    "Не должен",
                    "Должен, если не исключена возможность попадания извне вредных и взрывопожароопасных паров и газов"
                ],
                correct: 0,
                explanation: "Правильный ответ: Должен. Объяснение: Контроль воздушной среды при работах в замкнутом пространстве обязателен."
            },
            {
                question: "Что должны использовать лица, входящие в замкнутое пространство для отбора проб воздуха?",
                options: [
                    "Шланговый дыхательный аппарат",
                    "Автономный дыхательный аппарат или шланговый противогаз и средства страховки.",
                    "Фонарик и средства страховки",
                    "Респиратор, шланговый противогаз и средства страховки",
                    "Верно всё выше перечисленное"
                ],
                correct: 1,
                explanation: "Правильный ответ: Автономный дыхательный аппарат или шланговый противогаз и средства страховки. Объяснение: Для входа в замкнутое пространство необходимо использовать автономный дыхательный аппарат или шланговый противогаз со средствами страховки."
            },
            {
                question: "В каких случаях необходимо производить отбора проб воздуха при работах в замкнутом пространстве?",
                options: [
                    "При нахождении 1-го и более работников в замкнутом пространстве",
                    "При нахождении 2-х и более работников в замкнутом пространстве",
                    "При нахождении не менее 5 работников в замкнутом пространстве",
                    "Правильные ответы 1,2,3."
                ],
                correct: 3,
                explanation: "Правильный ответ: Правильные ответы 1,2,3. Объяснение: Отбор проб воздуха необходим при любом количестве работников в замкнутом пространстве."
            },
            {
                question: "Работа на высоте это?",
                options: [
                    "Это работа при которой существуют риски, связанные с возможным падением работника с высоты 1,6 м и более",
                    "Это работа при которой существуют риски, связанные с возможным падением работника с высоты 5 м и более",
                    "Это работа при которой существуют риски, связанные с возможным падением работника с высоты 1,8 м и более."
                ],
                correct: 2,
                explanation: "Правильный ответ: Это работа при которой существуют риски, связанные с возможным падением работника с высоты 1,8 м и более. Объяснение: Работа на высоте определяется риском падения с высоты 1,8 м и более."
            },
            {
                question: "Каким должен быть угол наклона лестницы к горизонтальной поверхности при осуществлении работником подъема на высоту более 5 м по этой лестнице?",
                options: [
                    "45°",
                    "75°.",
                    "120°",
                    "80°",
                    "Не имеет значения"
                ],
                correct: 1,
                explanation: "Правильный ответ: 75°. Объяснение: Угол наклона лестницы при подъеме на высоту более 5 м должен составлять 75°."
            },
            {
                question: "При какой скорости ветра запрещены работы на высоте для всех работ?",
                options: [
                    "15 м/сек и более.",
                    "10 м/сек и более",
                    "12 м/сек и более"
                ],
                correct: 0,
                explanation: "Правильный ответ: 15 м/сек и более. Объяснение: Для всех работ на высоте запрещена скорость ветра 15 м/с и более."
            },
            {
                question: "На каком максимально близком расстоянии допускается работа ГПМ в зоне ЛЭП?",
                options: [
                    "10м",
                    "20м",
                    "30м.",
                    "На любом расстоянии, при условии оформленного наряда-допуска",
                    "Правильные ответы 1 и 4"
                ],
                correct: 2,
                explanation: "Правильный ответ: 30м. Объяснение: Работа грузоподъемных механизмов в зоне ЛЭП допускается на расстоянии не менее 30м."
            },
            {
                question: "Какое должно быть обеспечено расстояние от бровки котлована до извлечённого из него грунта?",
                options: [
                    "0,5м.",
                    "1м",
                    "0,75м"
                ],
                correct: 0,
                explanation: "Правильный ответ: 0,5м. Объяснение: Расстояние от бровки котлована до извлеченного грунта должно быть не менее 0,5м."
            },
            {
                question: "Должны ли транспортные средства быть оборудованы шинами, соответствующими времени года?",
                options: [
                    "Должны.",
                    "Не должны"
                ],
                correct: 0,
                explanation: "Правильный ответ: Должны. Объяснение: Транспортные средства должны быть оборудованы шинами, соответствующими сезону."
            },
            {
                question: "Должен ли быть обеспечен необходимый контроль состояния воздушной среды на месте проведения огневых работ?",
                options: [
                    "Должен",
                    "Не должен",
                    "Только при условии, если имеется возможность выделения в воздух рабочей зоны взрывопожароопасных или вредных паров, газов и других веществ"
                ],
                correct: 0,
                explanation: "Правильный ответ: Должен. Объяснение: Контроль воздушной среды при огневых работах обязателен."
            },
            {
                question: "Какая дистанция должна быть между транспортными средствами при движении по ледовым переправам? (Инструкция № П3-05 И-0016 Приложение №1 п. 3.10.)",
                options: [
                    "10м",
                    "20м",
                    "30м.",
                    "50м"
                ],
                correct: 2,
                explanation: "Правильный ответ: 30м. Объяснение: При движении по ледовым переправам дистанция между транспортными средствами должна быть не менее 30м."
            },
            {
                question: "Для кого обязательны выполнения требований «Золотых правил по безопасности труда»?",
                options: [
                    "Работниками ПАО «НК «Роснефть» и Обществ Группы",
                    "Персоналом подрядных (субподрядных) организаций",
                    "Только персоналом подрядных организаций",
                    "Всем сотрудникам ООО «РН-Юганскнефтегаз»",
                    "Работниками ПАО «НК «Роснефть» и Обществ Группы, персоналом подрядных/субподрядных организаций."
                ],
                correct: 4,
                explanation: "Правильный ответ: Работниками ПАО «НК «Роснефть» и Обществ Группы, персоналом подрядных/субподрядных организаций. Объяснение: Требования «Золотых правил» обязательны для всех работников компании и подрядных организаций."
            }
        ];
        
        // Глобальные переменные
        let currentTrainingIndex = 0;
        let examQuestions = [];
        let currentExamIndex = 0;
        let examTimer;
        let examTimeLeft = 30 * 60; // 30 минут в секундах
        let userAnswers = [];
        let ticketSize;
        let hintsRemaining = 3;
        let favorites = [];
        let incorrectAnswers = [];
        let currentFavoritesIndex = 0;
        let currentTrainerIndex = 0;
        let currentCardIndex = 0;
        let searchResults = [];
        let currentCategory = 'all';
        let currentGoldRulesIndex = 0;
        let goldRulesUserAnswers = [];
        let userName = '';
        let leaderboardData = [];
        let feedbackData = [];
        
        // Показать экран
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            // Обновляем статистику при входе в админку
            if (screenId === 'adminScreen') {
                displayStats();
                displayFeedbackList();
            }
            
            // Загружаем таблицу лидеров
            if (screenId === 'leaderboardScreen') {
                loadLeaderboard();
            }
        }
        
        // Вернуться в начало
        function backToStart() {
            clearInterval(examTimer);
            updateAchievements();
            showScreen('startScreen');
        }
        
        // Сохранение данных в localStorage
        function saveData() {
            localStorage.setItem('favorites', JSON.stringify(favorites));
            localStorage.setItem('incorrectAnswers', JSON.stringify(incorrectAnswers));
            localStorage.setItem('trainingProgress', JSON.stringify({
                currentIndex: currentTrainingIndex,
                hintsRemaining: hintsRemaining
            }));
            localStorage.setItem('darkTheme', document.body.classList.contains('dark-theme'));
            localStorage.setItem('customQuestions', JSON.stringify(questions));
            localStorage.setItem('userName', userName);
            localStorage.setItem('leaderboardData', JSON.stringify(leaderboardData));
            localStorage.setItem('feedbackData', JSON.stringify(feedbackData));
        }
        
        // Загрузка данных из localStorage
        function loadData() {
            const savedFavorites = localStorage.getItem('favorites');
            if (savedFavorites) {
                favorites = JSON.parse(savedFavorites);
            }
            
            const savedIncorrect = localStorage.getItem('incorrectAnswers');
            if (savedIncorrect) {
                incorrectAnswers = JSON.parse(savedIncorrect);
            }
            
            const savedProgress = localStorage.getItem('trainingProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentTrainingIndex = progress.currentIndex || 0;
                hintsRemaining = progress.hintsRemaining || 3;
            }
            
            const savedTheme = localStorage.getItem('darkTheme');
            if (savedTheme === 'true') {
                document.body.classList.add('dark-theme');
                document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            const savedQuestions = localStorage.getItem('customQuestions');
            if (savedQuestions) {
                try {
                    const parsedQuestions = JSON.parse(savedQuestions);
                    if (Array.isArray(parsedQuestions) && parsedQuestions.length > 0) {
                        questions.length = 0;
                        questions.push(...parsedQuestions);
                    }
                } catch (e) {
                    console.error('Ошибка загрузки вопросов из localStorage:', e);
                }
            }
            
            const savedUserName = localStorage.getItem('userName');
            if (savedUserName) {
                userName = savedUserName;
            }
            
            const savedLeaderboard = localStorage.getItem('leaderboardData');
            if (savedLeaderboard) {
                try {
                    leaderboardData = JSON.parse(savedLeaderboard);
                } catch (e) {
                    console.error('Ошибка загрузки таблицы лидеров:', e);
                }
            }
            
            const savedFeedback = localStorage.getItem('feedbackData');
            if (savedFeedback) {
                try {
                    feedbackData = JSON.parse(savedFeedback);
                } catch (e) {
                    console.error('Ошибка загрузки обратной связи:', e);
                }
            }
        }
        
        // Сохранение статистики экзамена
        function saveExamStats(percentage, timeSpent, questionCount) {
            const stats = JSON.parse(localStorage.getItem('examStats') || '[]');
            stats.push({
                date: new Date().toISOString(),
                percentage: percentage,
                timeSpent: timeSpent,
                questionCount: questionCount
            });
            localStorage.setItem('examStats', JSON.stringify(stats));
        }
        
        // Обновление достижений
        function updateAchievements() {
            const stats = JSON.parse(localStorage.getItem('examStats') || '[]');
            const totalQuestions = favorites.length + incorrectAnswers.length;
            
            // Достижение 1: Новичок (пройден первый экзамен)
            if (stats.length > 0 && document.getElementById('achievement1').classList.contains('locked')) {
                document.getElementById('achievement1').classList.remove('locked');
                document.getElementById('achievement1').classList.add('unlocked');
                showAchievementModal('Новичок', 'Вы прошли свой первый экзамен!');
            }
            
            // Достижение 2: Стремительный (экзамен пройден быстрее чем за 15 минут)
            const fastExam = stats.some(stat => stat.timeSpent < 15 * 60);
            if (fastExam && document.getElementById('achievement2').classList.contains('locked')) {
                document.getElementById('achievement2').classList.remove('locked');
                document.getElementById('achievement2').classList.add('unlocked');
                showAchievementModal('Стремительный', 'Вы сдали экзамен быстрее чем за 15 минут!');
            }
            
            // Достижение 3: Эксперт (5 экзаменов с результатом 90% и выше)
            const excellentExams = stats.filter(stat => stat.percentage >= 90).length;
            if (excellentExams >= 5 && document.getElementById('achievement3').classList.contains('locked')) {
                document.getElementById('achievement3').classList.remove('locked');
                document.getElementById('achievement3').classList.add('unlocked');
                showAchievementModal('Эксперт', 'Вы сдали 5 экзаменов на отлично!');
            }
            
            // Достижение 4: Мастер (более 20 избранных вопросов)
            if (favorites.length >= 20 && document.getElementById('achievement4').classList.contains('locked')) {
                document.getElementById('achievement4').classList.remove('locked');
                document.getElementById('achievement4').classList.add('unlocked');
                showAchievementModal('Мастер', 'Вы добавили более 20 вопросов в избранное!');
            }
            
            // Достижение 5: Золотой мастер (пройдены все Золотые правила)
            const goldRulesCompleted = localStorage.getItem('goldRulesCompleted') === 'true';
            if (goldRulesCompleted && document.getElementById('achievement5').classList.contains('locked')) {
                document.getElementById('achievement5').classList.remove('locked');
                document.getElementById('achievement5').classList.add('unlocked');
                showAchievementModal('Золотой мастер', 'Вы полностью освоили Золотые правила безопасности!');
            }
        }
        
        // Показать модальное окно достижения
        function showAchievementModal(name, description) {
            document.getElementById('achievementName').textContent = name;
            document.getElementById('achievementDescription').textContent = description;
            document.getElementById('achievementModal').style.display = 'block';
        }
        
        // Закрыть модальное окно достижения
        function closeAchievementModal() {
            document.getElementById('achievementModal').style.display = 'none';
        }
        
        // Создание конфетти
        function createConfetti() {
            const container = document.getElementById('confetti-container');
            const colors = ['#3498db', '#2ecc71', '#f39c12', '#e74c3c', '#9b59b6'];
            
            for (let i = 0; i < 150; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = Math.random() * 10 + 5 + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.opacity = Math.random() * 0.8 + 0.2;
                    confetti.style.animationDuration = Math.random() * 3 + 2 + 's';
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    
                    container.appendChild(confetti);
                    
                    // Удалить элемент после завершения анимации
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }, i * 30);
            }
        }
        
        // Переключение темы
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            document.getElementById('themeToggle').innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            saveData();
        }
        
        // Эффект печатания для текста вопроса
        function typeWriter(elementId, text, speed = 30) {
            const element = document.getElementById(elementId);
            element.textContent = '';
            let i = 0;
            
            function type() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            
            type();
        }
        
        // Обновление общего прогресса
        function updateOverallProgress() {
            const progress = (currentTrainingIndex / questions.length) * 100;
            document.getElementById('overallProgressFill').style.width = `${progress}%`;
            document.getElementById('overallProgressText').textContent = `${Math.round(progress)}%`;
        }
        
        // Начать режим обучения
        function startTraining() {
            loadData();
            userAnswers = [];
            showScreen('trainingScreen');
            updateHintInfo();
            updateOverallProgress();
            showTrainingQuestion();
        }
        
        // Обновить информацию о подсказках
        function updateHintInfo() {
            document.getElementById('hintInfo').textContent = `Подсказок осталось: ${hintsRemaining}`;
            document.getElementById('hintBtn').disabled = hintsRemaining <= 0;
        }
        
        // Показать вопрос в режиме обучения
        function showTrainingQuestion() {
            if (currentTrainingIndex >= questions.length) {
                backToStart();
                return;
            }
            
            const question = questions[currentTrainingIndex];
            typeWriter('trainingQuestion', question.question);
            
            const optionsContainer = document.getElementById('trainingOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectTrainingOption(index);
                optionElement.dataset.index = index;
                optionsContainer.appendChild(optionElement);
            });
            
            // Обновить прогресс
            const progress = ((currentTrainingIndex + 1) / questions.length) * 100;
            document.getElementById('trainingProgress').style.width = `${progress}%`;
            
            // Обновить общий прогресс
            updateOverallProgress();
            
            // Скрыть объяснение
            document.getElementById('trainingExplanation').classList.remove('show');
        }
        
        // Использовать подсказку
        function useHint() {
            if (hintsRemaining <= 0) return;
            
            const question = questions[currentTrainingIndex];
            const options = document.querySelectorAll('#trainingOptions .option');
            
            // Найти все неправильные варианты
            const incorrectOptions = [];
            for (let i = 0; i < options.length; i++) {
                if (i !== question.correct) {
                    incorrectOptions.push(i);
                }
            }
            
            // Удалить один случайный неправильный вариант
            if (incorrectOptions.length > 0) {
                const randomIndex = Math.floor(Math.random() * incorrectOptions.length);
                const optionToRemove = incorrectOptions[randomIndex];
                options[optionToRemove].style.display = 'none';
                options[optionToRemove].classList.add('disabled');
            }
            
            hintsRemaining--;
            updateHintInfo();
            saveData();
        }
        
        // Выбор ответа в режиме обучения
        function selectTrainingOption(optionIndex) {
            const question = questions[currentTrainingIndex];
            const options = document.querySelectorAll('#trainingOptions .option');
            
            // Отключить все варианты
            options.forEach(opt => {
                opt.onclick = null;
                opt.classList.add('disabled');
            });
            
            // Подсветить выбранный вариант
            options[optionIndex].classList.add(optionIndex === question.correct ? 'correct' : 'incorrect');
            
            // Если ответ неверный, подсветить правильный
            if (optionIndex !== question.correct) {
                options[question.correct].classList.add('correct');
                
                // Добавить в список неправильных ответов
                if (!incorrectAnswers.includes(currentTrainingIndex)) {
                    incorrectAnswers.push(currentTrainingIndex);
                }
            }
            
            // Показать объяснение
            const explanationElement = document.getElementById('trainingExplanation');
            explanationElement.textContent = question.explanation;
            explanationElement.classList.add('show');
            
            // Сохранить ответ
            userAnswers.push({
                questionIndex: currentTrainingIndex,
                selectedOption: optionIndex,
                isCorrect: optionIndex === question.correct
            });
            
            // Сохранить прогресс
            saveData();
            
            // Переход к следующему вопросу
            currentTrainingIndex++;
            setTimeout(() => {
                showTrainingQuestion();
            }, 3000);
        }
        
        // Начать экзамен
        function startExam() {
            // Определить размер билета (10 или 13 вопросов)
            ticketSize = Math.random() < 0.5 ? 10 : 13;
            
            // Создать случайный билет
            const shuffled = [...questions].sort(() => 0.5 - Math.random());
            examQuestions = shuffled.slice(0, ticketSize);
            
            currentExamIndex = 0;
            userAnswers = [];
            examTimeLeft = 30 * 60; // 30 минут
            
            showScreen('examScreen');
            document.getElementById('ticketInfo').textContent = `Билет №${Math.floor(Math.random() * 100) + 1} (${ticketSize} вопросов)`;
            startExamTimer();
            showExamQuestion();
        }
        
        // Таймер экзамена
        function startExamTimer() {
            examTimer = setInterval(() => {
                examTimeLeft--;
                
                const minutes = Math.floor(examTimeLeft / 60);
                const seconds = examTimeLeft % 60;
                document.getElementById('examTimer').textContent = 
                    `Осталось времени: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                
                if (examTimeLeft <= 0) {
                    finishExam();
                }
            }, 1000);
        }
        
        // Показать вопрос в режиме экзамена
        function showExamQuestion() {
            if (currentExamIndex >= examQuestions.length) {
                finishExam();
                return;
            }
            
            const question = examQuestions[currentExamIndex];
            document.getElementById('examQuestion').textContent = question.question;
            
            const optionsContainer = document.getElementById('examOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectExamOption(index);
                optionsContainer.appendChild(optionElement);
            });
            
            // Обновить прогресс
            const progress = ((currentExamIndex + 1) / examQuestions.length) * 100;
            document.getElementById('examProgress').style.width = `${progress}%`;
            
            // Скрыть объяснение
            document.getElementById('examExplanation').classList.remove('show');
        }
        
        // Выбор ответа в режиме экзамена
        function selectExamOption(optionIndex) {
            const question = examQuestions[currentExamIndex];
            const options = document.querySelectorAll('#examOptions .option');
            
            // Отключить все варианты
            options.forEach(opt => {
                opt.onclick = null;
                opt.classList.add('disabled');
            });
            
            // Подсветить выбранный вариант
            options[optionIndex].classList.add(optionIndex === question.correct ? 'correct' : 'incorrect');
            
            // Если ответ неверный, подсветить правильный
            if (optionIndex !== question.correct) {
                options[question.correct].classList.add('correct');
                
                // Добавить в список неправильных
                const originalIndex = questions.indexOf(question);
                if (!incorrectAnswers.includes(originalIndex)) {
                    incorrectAnswers.push(originalIndex);
                    saveData();
                }
            }
            
            // Показать объяснение
            const explanationElement = document.getElementById('examExplanation');
            explanationElement.textContent = question.explanation;
            explanationElement.classList.add('show');
            
            // Сохранить ответ
            userAnswers.push({
                questionIndex: currentExamIndex,
                selectedOption: optionIndex,
                isCorrect: optionIndex === question.correct
            });
            
            currentExamIndex++;
            setTimeout(() => {
                showExamQuestion();
            }, 1500);
        }
        
        // Завершить экзамен
        function finishExam() {
            clearInterval(examTimer);
            
            // Подсчет правильных ответов
            const correctAnswers = userAnswers.filter(answer => answer.isCorrect).length;
            const percentage = Math.round((correctAnswers / examQuestions.length) * 100);
            
            // Сохранить статистику
            const timeSpent = 30 * 60 - examTimeLeft;
            saveExamStats(percentage, timeSpent, examQuestions.length);
            
            // Добавить в таблицу лидеров
            addToLeaderboard(percentage, timeSpent);
            
            // Показать результаты
            showScreen('resultScreen');
            document.getElementById('resultScore').textContent = `${percentage}%`;
            
            let message = '';
            if (percentage >= 90) {
                message = 'Отлично! Вы сдали экзамен на отлично!';
            } else if (percentage >= 70) {
                message = 'Хорошо! Вы успешно сдали экзамен.';
            } else if (percentage >= 50) {
                message = 'Удовлетворительно. Рекомендуется повторить материал.';
            } else {
                message = 'Экзамен не сдан. Необходимо подготовиться и попробовать снова.';
            }
            
            document.getElementById('resultMessage').textContent = message;
            
            // Добавить конфетти при успешном результате
            if (percentage >= 70) {
                createConfetti();
            }
        }
        
        // Добавить результат в таблицу лидеров
        function addToLeaderboard(percentage, timeSpent) {
            // Запросить имя пользователя, если его нет
            if (!userName) {
                showNameModal();
                return;
            }
            
            const entry = {
                name: userName,
                score: percentage,
                time: timeSpent,
                date: new Date().toISOString()
            };
            
            // Добавить запись в начало массива
            leaderboardData.unshift(entry);
            
            // Ограничить размер таблицы лидеров (топ 50)
            if (leaderboardData.length > 50) {
                leaderboardData = leaderboardData.slice(0, 50);
            }
            
            // Сохранить в localStorage
            saveData();
        }
        
        // Показать модальное окно для ввода имени
        function showNameModal() {
            document.getElementById('nameModal').style.display = 'block';
            document.getElementById('userName').value = '';
            document.getElementById('userName').focus();
        }
        
        // Сохранить имя пользователя
        function saveUserName() {
            const nameInput = document.getElementById('userName');
            const name = nameInput.value.trim();
            
            if (name) {
                userName = name;
                saveData();
                closeNameModal();
                
                // Если мы завершили экзамен, добавляем результат в таблицу лидеров
                if (userAnswers.length > 0) {
                    const correctAnswers = userAnswers.filter(answer => answer.isCorrect).length;
                    const percentage = Math.round((correctAnswers / examQuestions.length) * 100);
                    const timeSpent = 30 * 60 - examTimeLeft;
                    addToLeaderboard(percentage, timeSpent);
                }
            }
        }
        
        // Закрыть модальное окно имени
        function closeNameModal() {
            document.getElementById('nameModal').style.display = 'none';
        }
        
        // Начать режим таблицы лидеров
        function startLeaderboard() {
            showScreen('leaderboardScreen');
            loadLeaderboard();
        }
        
        // Загрузить и отобразить таблицу лидеров
        function loadLeaderboard() {
            const content = document.getElementById('leaderboardContent');
            
            if (leaderboardData.length === 0) {
                content.innerHTML = '<div class="no-leaderboard">Нет результатов в таблице лидеров</div>';
                return;
            }
            
            // Сортировка по баллам (по убыванию)
            const sortedData = [...leaderboardData].sort((a, b) => {
                if (b.score !== a.score) {
                    return b.score - a.score;
                }
                return a.time - b.time; // При равных баллах - по времени
            });
            
            // Создаем таблицу
            let tableHTML = `
                <table class="leaderboard-table">
                    <thead>
                        <tr>
                            <th>Место</th>
                            <th>Имя</th>
                            <th>Результат</th>
                            <th>Время</th>
                            <th>Дата</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Добавляем топ 10 результатов
            for (let i = 0; i < Math.min(10, sortedData.length); i++) {
                const entry = sortedData[i];
                const date = new Date(entry.date);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}.${(date.getMonth() + 1).toString().padStart(2, '0')}.${date.getFullYear()}`;
                const minutes = Math.floor(entry.time / 60);
                const seconds = entry.time % 60;
                const formattedTime = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Особое оформление для топ-3
                let rankClass = '';
                let rankIcon = '';
                if (i === 0) {
                    rankClass = 'leaderboard-rank';
                    rankIcon = '🥇';
                } else if (i === 1) {
                    rankClass = 'leaderboard-rank';
                    rankIcon = '🥈';
                } else if (i === 2) {
                    rankClass = 'leaderboard-rank';
                    rankIcon = '🥉';
                }
                
                tableHTML += `
                    <tr>
                        <td class="${rankClass}">${rankIcon} ${i + 1}</td>
                        <td>${entry.name}</td>
                        <td class="leaderboard-score">${entry.score}%</td>
                        <td>${formattedTime}</td>
                        <td class="leaderboard-date">${formattedDate}</td>
                    </tr>
                `;
            }
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            content.innerHTML = tableHTML;
        }
        
        // Начать режим обратной связи
        function startFeedback() {
            showScreen('feedbackScreen');
            document.getElementById('feedbackForm').reset();
            document.getElementById('feedbackSuccess').style.display = 'none';
        }
        
        // Обработчик отправки формы обратной связи
        document.addEventListener('DOMContentLoaded', function() {
            const feedbackForm = document.getElementById('feedbackForm');
            if (feedbackForm) {
                feedbackForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('feedbackName').value.trim();
                    const email = document.getElementById('feedbackEmail').value.trim();
                    const message = document.getElementById('feedbackMessage').value.trim();
                    
                    if (message) {
                        const feedback = {
                            name: name || 'Аноним',
                            email: email || '',
                            message: message,
                            date: new Date().toISOString()
                        };
                        
                        feedbackData.unshift(feedback);
                        saveData();
                        
                        // Показать сообщение об успехе
                        document.getElementById('feedbackSuccess').style.display = 'block';
                        document.getElementById('feedbackForm').reset();
                        
                        // Скрыть сообщение через 3 секунды
                        setTimeout(() => {
                            document.getElementById('feedbackSuccess').style.display = 'none';
                        }, 3000);
                    }
                });
            }
        });
        
        // Отобразить список предложений в админке
        function displayFeedbackList() {
            const feedbackList = document.getElementById('feedbackList');
            
            if (feedbackData.length === 0) {
                feedbackList.innerHTML = '<div class="no-stats">Нет предложений</div>';
                return;
            }
            
            let html = '';
            feedbackData.forEach((feedback, index) => {
                const date = new Date(feedback.date);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}.${(date.getMonth() + 1).toString().padStart(2, '0')}.${date.getFullYear()} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                
                html += `
                    <div class="question-container" style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong>${feedback.name}</strong>
                            <span style="font-size: 0.9rem; opacity: 0.7;">${formattedDate}</span>
                        </div>
                        <div style="margin-bottom: 10px;">${feedback.message}</div>
                        ${feedback.email ? `<div style="font-size: 0.9rem; opacity: 0.7;">Email: ${feedback.email}</div>` : ''}
                    </div>
                `;
            });
            
            feedbackList.innerHTML = html;
        }
        
        // Начать режим избранных вопросов
        function startFavorites() {
            loadData();
            
            if (favorites.length === 0) {
                alert('У вас нет избранных вопросов');
                return;
            }
            
            currentFavoritesIndex = 0;
            userAnswers = [];
            showScreen('favoritesScreen');
            document.getElementById('favoritesCount').textContent = favorites.length;
            showFavoritesQuestion();
        }
        
        // Показать избранный вопрос
        function showFavoritesQuestion() {
            if (currentFavoritesIndex >= favorites.length) {
                backToStart();
                return;
            }
            
            const questionIndex = favorites[currentFavoritesIndex];
            const question = questions[questionIndex];
            document.getElementById('favoritesQuestion').textContent = question.question;
            
            const optionsContainer = document.getElementById('favoritesOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectFavoritesOption(index);
                optionsContainer.appendChild(optionElement);
            });
            
            // Обновить прогресс
            const progress = ((currentFavoritesIndex + 1) / favorites.length) * 100;
            document.getElementById('favoritesProgress').style.width = `${progress}%`;
            
            // Скрыть объяснение
            document.getElementById('favoritesExplanation').classList.remove('show');
        }
        
        // Выбор ответа в режиме избранных вопросов
        function selectFavoritesOption(optionIndex) {
            const questionIndex = favorites[currentFavoritesIndex];
            const question = questions[questionIndex];
            const options = document.querySelectorAll('#favoritesOptions .option');
            
            // Отключить все варианты
            options.forEach(opt => {
                opt.onclick = null;
                opt.classList.add('disabled');
            });
            
            // Подсветить выбранный вариант
            options[optionIndex].classList.add(optionIndex === question.correct ? 'correct' : 'incorrect');
            
            // Если ответ неверный, подсветить правильный
            if (optionIndex !== question.correct) {
                options[question.correct].classList.add('correct');
            }
            
            // Показать объяснение
            const explanationElement = document.getElementById('favoritesExplanation');
            explanationElement.textContent = question.explanation;
            explanationElement.classList.add('show');
            
            // Сохранить ответ
            userAnswers.push({
                questionIndex: questionIndex,
                selectedOption: optionIndex,
                isCorrect: optionIndex === question.correct
            });
            
            // Переход к следующему вопросу
            currentFavoritesIndex++;
            setTimeout(() => {
                showFavoritesQuestion();
            }, 2000);
        }
        
        // Начать режим тренажера
        function startTrainer() {
            loadData();
            
            if (incorrectAnswers.length === 0) {
                alert('У вас нет вопросов с ошибками');
                return;
            }
            
            currentTrainerIndex = 0;
            userAnswers = [];
            showScreen('trainerScreen');
            document.getElementById('trainerCount').textContent = incorrectAnswers.length;
            showTrainerQuestion();
        }
        
        // Показать вопрос в режиме тренажера
        function showTrainerQuestion() {
            if (currentTrainerIndex >= incorrectAnswers.length) {
                // Очистить список ошибок после успешного прохождения
                incorrectAnswers = [];
                saveData();
                backToStart();
                return;
            }
            
            const questionIndex = incorrectAnswers[currentTrainerIndex];
            const question = questions[questionIndex];
            document.getElementById('trainerQuestion').textContent = question.question;
            
            const optionsContainer = document.getElementById('trainerOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectTrainerOption(index);
                optionsContainer.appendChild(optionElement);
            });
            
            // Обновить прогресс
            const progress = ((currentTrainerIndex + 1) / incorrectAnswers.length) * 100;
            document.getElementById('trainerProgress').style.width = `${progress}%`;
            
            // Скрыть объяснение
            document.getElementById('trainerExplanation').classList.remove('show');
        }
        
        // Выбор ответа в режиме тренажера
        function selectTrainerOption(optionIndex) {
            const questionIndex = incorrectAnswers[currentTrainerIndex];
            const question = questions[questionIndex];
            const options = document.querySelectorAll('#trainerOptions .option');
            
            // Отключить все варианты
            options.forEach(opt => {
                opt.onclick = null;
                opt.classList.add('disabled');
            });
            
            // Подсветить выбранный вариант
            options[optionIndex].classList.add(optionIndex === question.correct ? 'correct' : 'incorrect');
            
            // Если ответ неверный, подсветить правильный
            if (optionIndex !== question.correct) {
                options[question.correct].classList.add('correct');
            }
            
            // Показать объяснение
            const explanationElement = document.getElementById('trainerExplanation');
            explanationElement.textContent = question.explanation;
            explanationElement.classList.add('show');
            
            // Сохранить ответ
            userAnswers.push({
                questionIndex: questionIndex,
                selectedOption: optionIndex,
                isCorrect: optionIndex === question.correct
            });
            
            // Если ответ правильный, удалить вопрос из списка ошибок
            if (optionIndex === question.correct) {
                incorrectAnswers.splice(currentTrainerIndex, 1);
                saveData();
            } else {
                currentTrainerIndex++;
            }
            
            // Переход к следующему вопросу
            setTimeout(() => {
                showTrainerQuestion();
            }, 2000);
        }
        
        // Начать режим поиска
        function startSearch() {
            showScreen('searchScreen');
            document.getElementById('searchInput').value = '';
            document.getElementById('searchResults').innerHTML = '<div class="no-stats">Введите ключевые слова для поиска</div>';
        }
        
        // Поиск вопросов
        function searchQuestions() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                document.getElementById('searchResults').innerHTML = '<div class="no-stats">Введите ключевые слова для поиска</div>';
                return;
            }
            
            // Фильтрация вопросов по поисковому запросу и категории
            searchResults = questions.filter(question => {
                const matchesSearch = question.question.toLowerCase().includes(searchTerm) || 
                                    question.options.some(option => option.toLowerCase().includes(searchTerm));
                const matchesCategory = currentCategory === 'all' || question.category === currentCategory;
                return matchesSearch && matchesCategory;
            });
            
            displaySearchResults();
        }
        
        // Отображение результатов поиска
        function displaySearchResults() {
            const resultsContainer = document.getElementById('searchResults');
            
            if (searchResults.length === 0) {
                resultsContainer.innerHTML = '<div class="no-stats">Ничего не найдено</div>';
                return;
            }
            
            resultsContainer.innerHTML = '';
            
            searchResults.forEach((question, index) => {
                const questionElement = document.createElement('div');
                questionElement.className = 'question-container';
                questionElement.innerHTML = `
                    <div class="question">${index + 1}. ${question.question}</div>
                    <div class="options">
                        ${question.options.map((option, i) => `
                            <div class="option ${i === question.correct ? 'correct' : ''}">${option}</div>
                        `).join('')}
                    </div>
                    <div class="explanation">${question.explanation}</div>
                `;
                resultsContainer.appendChild(questionElement);
            });
        }
        
        // Фильтрация по категориям
        function filterByCategory(category) {
            currentCategory = category;
            
            // Обновление активной кнопки
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Повторный поиск с новой категорией
            searchQuestions();
        }
        
        // Начать режим карточек
        function startCards() {
            currentCardIndex = 0;
            showScreen('cardsScreen');
            document.getElementById('cardBtn').innerHTML = '<i class="fas fa-arrow-right"></i> Далее';
            showCard();
        }
        
        // Показать карточку
        function showCard() {
            if (currentCardIndex >= questions.length) {
                currentCardIndex = 0;
            }
            
            const question = questions[currentCardIndex];
            document.getElementById('cardQuestion').textContent = question.question;
            document.getElementById('cardAnswer').textContent = question.options[question.correct];
            document.getElementById('cardAnswer').classList.remove('show');
        }
        
        // Следующая карточка
        function nextCard() {
            const answerElement = document.getElementById('cardAnswer');
            
            if (!answerElement.classList.contains('show')) {
                // Показать ответ
                answerElement.classList.add('show');
                document.getElementById('cardBtn').innerHTML = '<i class="fas fa-arrow-right"></i> Далее';
            } else {
                // Перейти к следующей карточке
                currentCardIndex++;
                document.getElementById('cardBtn').innerHTML = '<i class="fas fa-arrow-right"></i> Далее';
                showCard();
            }
        }
        
        // Начать режим Золотых правил
        function startGoldRules() {
            currentGoldRulesIndex = 0;
            goldRulesUserAnswers = [];
            showScreen('goldRulesScreen');
            document.getElementById('goldRulesCount').textContent = goldRulesQuestions.length;
            showGoldRulesQuestion();
        }
        
        // Показать вопрос в режиме Золотых правил
        function showGoldRulesQuestion() {
            if (currentGoldRulesIndex >= goldRulesQuestions.length) {
                // Завершение тестирования Золотых правил
                finishGoldRules();
                return;
            }
            
            const question = goldRulesQuestions[currentGoldRulesIndex];
            document.getElementById('goldRulesQuestion').textContent = question.question;
            
            const optionsContainer = document.getElementById('goldRulesOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectGoldRulesOption(index);
                optionsContainer.appendChild(optionElement);
            });
            
            // Обновить прогресс
            const progress = ((currentGoldRulesIndex + 1) / goldRulesQuestions.length) * 100;
            document.getElementById('goldRulesProgress').style.width = `${progress}%`;
            
            // Скрыть объяснение
            document.getElementById('goldRulesExplanation').classList.remove('show');
            
            // Обновить кнопку избранного
            updateGoldRulesFavoriteButton();
        }
        
        // Выбор ответа в режиме Золотых правил
        function selectGoldRulesOption(optionIndex) {
            const question = goldRulesQuestions[currentGoldRulesIndex];
            const options = document.querySelectorAll('#goldRulesOptions .option');
            
            // Отключить все варианты
            options.forEach(opt => {
                opt.onclick = null;
                opt.classList.add('disabled');
            });
            
            // Подсветить выбранный вариант
            options[optionIndex].classList.add(optionIndex === question.correct ? 'correct' : 'incorrect');
            
            // Если ответ неверный, подсветить правильный
            if (optionIndex !== question.correct) {
                options[question.correct].classList.add('correct');
            }
            
            // Показать объяснение
            const explanationElement = document.getElementById('goldRulesExplanation');
            explanationElement.textContent = question.explanation;
            explanationElement.classList.add('show');
            
            // Сохранить ответ
            goldRulesUserAnswers.push({
                questionIndex: currentGoldRulesIndex,
                selectedOption: optionIndex,
                isCorrect: optionIndex === question.correct
            });
            
            // Переход к следующему вопросу
            currentGoldRulesIndex++;
            setTimeout(() => {
                showGoldRulesQuestion();
            }, 2000);
        }
        
        // Завершение тестирования Золотых правил
        function finishGoldRules() {
            // Подсчет правильных ответов
            const correctAnswers = goldRulesUserAnswers.filter(answer => answer.isCorrect).length;
            const percentage = Math.round((correctAnswers / goldRulesQuestions.length) * 100);
            
            // Сохранить факт завершения
            if (percentage >= 80) {
                localStorage.setItem('goldRulesCompleted', 'true');
                updateAchievements();
            }
            
            // Показать результаты
            showScreen('resultScreen');
            document.getElementById('resultScore').textContent = `${percentage}%`;
            
            let message = '';
            if (percentage >= 90) {
                message = 'Отлично! Вы полностью освоили Золотые правила безопасности!';
            } else if (percentage >= 80) {
                message = 'Хорошо! Вы хорошо усвоили Золотые правила безопасности.';
            } else if (percentage >= 60) {
                message = 'Удовлетворительно. Рекомендуется повторить Золотые правила.';
            } else {
                message = 'Тест не сдан. Необходимо изучить Золотые правила безопасности.';
            }
            
            document.getElementById('resultMessage').textContent = message;
            
            // Добавить конфетти при успешном результате
            if (percentage >= 80) {
                createConfetti();
            }
        }
        
        // Обновить кнопку избранного для Золотых правил
        function updateGoldRulesFavoriteButton() {
            const favoriteBtn = document.getElementById('goldRulesFavoriteBtn');
            const originalIndex = questions.findIndex(q => 
                q.question === goldRulesQuestions[currentGoldRulesIndex].question
            );
            
            if (originalIndex !== -1 && favorites.includes(originalIndex)) {
                favoriteBtn.classList.add('active');
                favoriteBtn.innerHTML = '<i class="fas fa-star"></i> Удалить из избранного';
            } else {
                favoriteBtn.classList.remove('active');
                favoriteBtn.innerHTML = '<i class="fas fa-star"></i> Добавить в избранное';
            }
        }
        
        // Переключить избранное для Золотых правил
        function toggleGoldRulesFavorite() {
            const originalIndex = questions.findIndex(q => 
                q.question === goldRulesQuestions[currentGoldRulesIndex].question
            );
            
            if (originalIndex !== -1) {
                const favoriteIndex = favorites.indexOf(originalIndex);
                if (favoriteIndex !== -1) {
                    favorites.splice(favoriteIndex, 1);
                } else {
                    favorites.push(originalIndex);
                }
                saveData();
                updateGoldRulesFavoriteButton();
            }
        }
        
        // Показать модальное окно администратора
        function showAdminModal() {
            document.getElementById('adminModal').style.display = 'block';
            document.getElementById('adminPassword').value = '';
        }
        
        // Закрыть модальное окно администратора
        function closeAdminModal() {
            document.getElementById('adminModal').style.display = 'none';
        }
        
        // Проверка пароля администратора
        function checkAdminPassword() {
            const password = document.getElementById('adminPassword').value;
            // Пароль администратора: admin123
            if (password === 'admin123') {
                closeAdminModal();
                showScreen('adminScreen');
            } else {
                alert('Неверный пароль');
            }
        }
        
        // Импорт вопросов
        function importQuestions(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedQuestions = JSON.parse(e.target.result);
                    
                    // Проверка структуры импортируемых данных
                    if (!Array.isArray(importedQuestions)) {
                        throw new Error('Файл должен содержать массив вопросов');
                    }
                    
                    // Проверка каждого вопроса
                    for (let i = 0; i < importedQuestions.length; i++) {
                        const q = importedQuestions[i];
                        if (!q.question || !q.options || !Array.isArray(q.options) || 
                            q.correct === undefined || !q.category || !q.explanation) {
                            throw new Error(`Вопрос ${i + 1} имеет неверную структуру`);
                        }
                    }
                    
                    // Добавление импортированных вопросов
                    questions.push(...importedQuestions);
                    
                    // Сохранение в localStorage
                    saveData();
                    
                    // Показать статус успешного импорта
                    const statusElement = document.getElementById('importStatus');
                    statusElement.className = 'import-status success';
                    statusElement.textContent = `Успешно импортировано ${importedQuestions.length} вопросов`;
                    statusElement.style.display = 'block';
                    
                    // Скрыть статус через 3 секунды
                    setTimeout(() => {
                        statusElement.style.display = 'none';
                    }, 3000);
                    
                } catch (error) {
                    // Показать статус ошибки
                    const statusElement = document.getElementById('importStatus');
                    statusElement.className = 'import-status error';
                    statusElement.textContent = `Ошибка импорта: ${error.message}`;
                    statusElement.style.display = 'block';
                    
                    // Скрыть статус через 5 секунд
                    setTimeout(() => {
                        statusElement.style.display = 'none';
                    }, 5000);
                }
            };
            reader.readAsText(file);
        }
        
        // Экспорт вопросов
        function exportQuestions() {
            const dataStr = JSON.stringify(questions, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'questions_export.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }
        
        // Сбросить все вопросы
        function resetQuestions() {
            if (confirm('Вы уверены, что хотите сбросить все вопросы? Это действие нельзя отменить.')) {
                // Загрузка оригинальных вопросов
                location.reload();
            }
        }
        
        // Функции для работы со статистикой
        function initStats() {
            const now = new Date();
            const sessionStart = now.getTime();
            
            // Сохраняем время начала сессии
            sessionStorage.setItem('sessionStart', sessionStart);
            
            // Получаем существующую статистику
            let stats = JSON.parse(localStorage.getItem('appStats') || '{}');
            
            // Обновляем статистику
            stats.totalLaunches = (stats.totalLaunches || 0) + 1;
            stats.lastLaunch = now.toISOString();
            
            if (!stats.firstLaunch) {
                stats.firstLaunch = now.toISOString();
            }
            
            // Сохраняем обновленную статистику
            localStorage.setItem('appStats', JSON.stringify(stats));
            
            // Обработчик закрытия страницы
            window.addEventListener('beforeunload', function() {
                const sessionEnd = new Date().getTime();
                const sessionDuration = sessionEnd - parseInt(sessionStorage.getItem('sessionStart'));
                
                // Обновляем общее время использования
                stats.totalTime = (stats.totalTime || 0) + sessionDuration;
                localStorage.setItem('appStats', JSON.stringify(stats));
            });
        }
        
        function displayStats() {
            const stats = JSON.parse(localStorage.getItem('appStats') || '{}');
            
            // Общее количество запусков
            document.getElementById('totalLaunches').textContent = stats.totalLaunches || 0;
            
            // Общее время использования
            const totalTimeMs = stats.totalTime || 0;
            document.getElementById('totalTime').textContent = formatTime(totalTimeMs);
            
            // Среднее время использования
            const avgTimeMs = stats.totalLaunches ? totalTimeMs / stats.totalLaunches : 0;
            document.getElementById('avgTime').textContent = formatTime(avgTimeMs);
            
            // Последний запуск
            if (stats.lastLaunch) {
                const lastDate = new Date(stats.lastLaunch);
                document.getElementById('lastLaunch').textContent = formatDate(lastDate);
            } else {
                document.getElementById('lastLaunch').textContent = '-';
            }
            
            // Строим график использования
            buildUsageChart();
        }
        
        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            
            return `${hours}ч ${minutes}м`;
        }
        
        function formatDate(date) {
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();
            
            return `${day}.${month}.${year}`;
        }
        
        function buildUsageChart() {
            const chartContainer = document.getElementById('usageChart');
            chartContainer.innerHTML = '';
            
            // Получаем статистику за последние 7 дней
            const stats = JSON.parse(localStorage.getItem('appStats') || '{}');
            const dailyStats = JSON.parse(localStorage.getItem('dailyStats') || '{}');
            
            // Создаем данные за последние 7 дней
            const chartData = [];
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = formatDate(date);
                
                chartData.push({
                    date: dateStr,
                    launches: dailyStats[dateStr] || 0
                });
            }
            
            // Находим максимальное значение для масштабирования
            const maxLaunches = Math.max(...chartData.map(d => d.launches), 1);
            
            // Создаем столбцы графика
            chartData.forEach((data, index) => {
                const barHeight = (data.launches / maxLaunches) * 150;
                const barLeft = 15 + index * 45;
                
                // Создаем столбец
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${barHeight}px`;
                bar.style.left = `${barLeft}px`;
                
                // Создаем подпись
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.textContent = data.date.substring(0, 5); // Только день и месяц
                label.style.left = `${barLeft}px`;
                
                // Добавляем значение над столбцом
                if (data.launches > 0) {
                    const value = document.createElement('div');
                    value.style.position = 'absolute';
                    value.style.bottom = `${barHeight + 20}px`;
                    value.style.left = `${barLeft}px`;
                    value.style.width = '30px';
                    value.style.textAlign = 'center';
                    value.style.fontSize = '0.8rem';
                    value.style.fontWeight = 'bold';
                    value.textContent = data.launches;
                    chartContainer.appendChild(value);
                }
                
                chartContainer.appendChild(bar);
                chartContainer.appendChild(label);
            });
        }
        
        function exportStats() {
            const stats = JSON.parse(localStorage.getItem('appStats') || '{}');
            const dailyStats = JSON.parse(localStorage.getItem('dailyStats') || '{}');
            const examStats = JSON.parse(localStorage.getItem('examStats') || '[]');
            
            const exportData = {
                appStats: stats,
                dailyStats: dailyStats,
                examStats: examStats,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'app_stats_export.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }
        
        function resetStats() {
            if (confirm('Вы уверены, что хотите сбросить всю статистику использования?')) {
                localStorage.removeItem('appStats');
                localStorage.removeItem('dailyStats');
                displayStats();
            }
        }
        
        // Обновление ежедневной статистики
        function updateDailyStats() {
            const today = formatDate(new Date());
            let dailyStats = JSON.parse(localStorage.getItem('dailyStats') || '{}');
            
            dailyStats[today] = (dailyStats[today] || 0) + 1;
            localStorage.setItem('dailyStats', JSON.stringify(dailyStats));
        }
        
        // Инициализация при загрузке страницы
        window.onload = function() {
            loadData();
            updateAchievements();
            initStats();
            updateDailyStats();
            
            // Регистрация Service Worker для PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('data:application/javascript;base64,' + btoa(`
                    self.addEventListener('install', function(e) {
                        self.skipWaiting();
                    });
                    
                    self.addEventListener('activate', function(e) {
                        self.registration.unregister();
                    });
                `));
            }
            
            // Обработчик для формы обратной связи
            const feedbackForm = document.getElementById('feedbackForm');
            if (feedbackForm) {
                feedbackForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('feedbackName').value.trim();
                    const email = document.getElementById('feedbackEmail').value.trim();
                    const message = document.getElementById('feedbackMessage').value.trim();
                    
                    if (message) {
                        const feedback = {
                            name: name || 'Аноним',
                            email: email || '',
                            message: message,
                            date: new Date().toISOString()
                        };
                        
                        feedbackData.unshift(feedback);
                        saveData();
                        
                        // Показать сообщение об успехе
                        document.getElementById('feedbackSuccess').style.display = 'block';
                        document.getElementById('feedbackForm').reset();
                        
                        // Скрыть сообщение через 3 секунды
                        setTimeout(() => {
                            document.getElementById('feedbackSuccess').style.display = 'none';
                        }, 3000);
                    }
                });
            }
        };
        
        // Обработка нажатия Enter в поле пароля
        document.getElementById('adminPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkAdminPassword();
            }
        });
        
        // Обработка нажатия Enter в поле имени пользователя
        document.getElementById('userName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                saveUserName();
            }
        });
    </script>
</body>
</html>
